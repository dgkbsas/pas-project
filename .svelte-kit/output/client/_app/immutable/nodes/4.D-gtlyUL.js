import"../chunks/CWj6FrbW.js";import{c as Gt,o as Wt}from"../chunks/B5RiWETq.js";import{a8 as Ct,aX as lt,aY as Xt,b as m,d as s,aa as r,c as It,f as H,A as t,a as p,g as a,t as A,ab as k,az as vt,M as ct,a9 as Mt,av as dt,aD as b,a4 as W,aW as Yt,ax as X,aw as kt,a1 as Ht,ay as Jt,aA as Kt,aE as St}from"../chunks/T0dPp4D2.js";import{i as I}from"../chunks/iIrk5DBN.js";import{e as pt,i as ht}from"../chunks/D_uDkMHU.js";import{s as ut,r as Et}from"../chunks/BjbfY3vJ.js";import{b as Ot,a as Qt}from"../chunks/DmB7dAFv.js";import{g as _t}from"../chunks/CdRlIqj1.js";import{B as Vt}from"../chunks/BpcvKk5C.js";/* empty css                */import{P as Zt,E as te,T as ee}from"../chunks/BU4vvWGd.js";import{d as ae,S as se,a as re}from"../chunks/ASvXjQD7.js";import"../chunks/Yaf_2f41.js";import{s as oe}from"../chunks/BqiCCWh5.js";import{i as ie}from"../chunks/C-YwpxQJ.js";import{p as $}from"../chunks/x5bn8cLp.js";import{s as Y}from"../chunks/C8FjytsP.js";import{U as ne}from"../chunks/CZE326ez.js";import{F as le}from"../chunks/CxVX8zWa.js";import{S as ve}from"../chunks/DbvMrZnG.js";import{T as ce}from"../chunks/q7TW0UXd.js";import{M as de}from"../chunks/BTHszUwG.js";import{P as pe}from"../chunks/BDn2B5Ob.js";var he=m('<div class="pagination-info svelte-f7rahb">Mostrando <span class="font-semibold svelte-f7rahb"> </span> a <span class="font-semibold svelte-f7rahb"> </span> de <span class="font-semibold svelte-f7rahb"> </span> resultados</div>'),ue=m('<button type="button"> </button>'),_e=m('<span class="pagination-dots svelte-f7rahb">...</span>'),me=m('<div class="pagination svelte-f7rahb"><!> <div class="pagination-controls svelte-f7rahb"><button type="button" class="pagination-btn svelte-f7rahb" aria-label="Página anterior"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-f7rahb"><path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-f7rahb"></path></svg></button> <!> <button type="button" class="pagination-btn svelte-f7rahb" aria-label="Página siguiente"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-f7rahb"><path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-f7rahb"></path></svg></button></div></div>');function fe(M,h){Ct(h,!1);const _=ct(),S=ct(),x=ct();let n=$(h,"currentPage",8,1),i=$(h,"totalPages",8,1),z=$(h,"totalItems",8,0),P=$(h,"itemsPerPage",8,10),J=$(h,"siblingCount",8,1),B=$(h,"showInfo",8,!0);const D=Gt();function j(l){l<1||l>i()||l===n()||D("change",l)}function R(){const l=[],u=Math.max(n()-J(),1),e=Math.min(n()+J(),i()),v=u>2,o=e<i()-1;i()>0&&l.push(1),v&&l.push("...");for(let c=u;c<=e;c++)c!==1&&c!==i()&&l.push(c);return o&&l.push("..."),i()>1&&l.push(i()),l}lt(()=>(W(n()),W(P())),()=>{b(_,(n()-1)*P()+1)}),lt(()=>(W(n()),W(P()),W(z())),()=>{b(S,Math.min(n()*P(),z()))}),lt(()=>{},()=>{b(x,R())}),Xt(),ie();var E=me(),F=s(E);{var K=l=>{var u=he(),e=r(s(u)),v=s(e,!0);a(e);var o=r(e,2),c=s(o,!0);a(o);var f=r(o,2),d=s(f,!0);a(f),dt(),a(u),A(()=>{k(v,t(_)),k(c,t(S)),k(d,z())}),p(l,u)};I(F,l=>{B()&&z()>0&&l(K)})}var U=r(F,2),T=s(U),L=r(T,2);pt(L,1,()=>t(x),ht,(l,u)=>{var e=It(),v=H(e);{var o=f=>{var d=ue();let C;var N=s(d,!0);a(d),A(V=>{C=oe(d,1,"pagination-btn page-number svelte-f7rahb",null,C,V),ut(d,"aria-label",`Ir a página ${t(u)??""}`),ut(d,"aria-current",t(u)===n()?"page":void 0),k(N,t(u))},[()=>({active:t(u)===n()})]),vt("click",d,()=>j(t(u))),p(f,d)},c=f=>{var d=_e();p(f,d)};I(v,f=>{typeof t(u)=="number"?f(o):f(c,!1)})}p(l,e)});var O=r(L,2);a(U),a(E),A(()=>{T.disabled=n()===1,O.disabled=n()===i()}),vt("click",T,()=>j(n()-1)),vt("click",O,()=>j(n()+1)),p(M,E),Mt()}var ge=m("<!> Nuevo Cliente",1),be=(M,h,_,S)=>{localStorage.setItem("clients_show_inactive",t(h).toString()),t(_).page=1,S()},xe=m('<div class="skeleton-list svelte-1hp9571"></div>'),ye=m('<div class="email svelte-1hp9571"><!> </div>'),we=m('<span class="text-muted svelte-1hp9571">-</span>'),Pe=m('<div class="phone svelte-1hp9571"><!> </div>'),ke=m('<span class="text-muted svelte-1hp9571">-</span>'),Se=(M,h)=>_t(`/clientes/${t(h).id}/editar`),Ee=(M,h,_)=>h(t(_).id,t(_).first_name,t(_).last_name),Ce=m('<tr><td><a class="client-name svelte-1hp9571"> </a></td><td><!></td><td><!></td><td> </td><td class="text-center"><div class="policies-count svelte-1hp9571"><!> <span> </span></div></td><td class="text-right"><div class="actions svelte-1hp9571"><button class="action-btn svelte-1hp9571" title="Editar"><!></button> <button class="action-btn danger svelte-1hp9571" title="Eliminar"><!></button></div></td></tr>'),Ie=m('<thead><tr><th>Nombre</th><th>Email</th><th>Teléfono</th><th>Ciudad</th><th class="text-center">Pólizas</th><th class="text-right">Acciones</th></tr></thead> <tbody></tbody>',1),Me=m("<!> <!>",1),ze=m('<div class="page svelte-1hp9571"><div class="page-header svelte-1hp9571"><div><h1 class="svelte-1hp9571">Clientes</h1> <p class="svelte-1hp9571">Gestiona tus clientes y su información</p></div> <!></div> <div class="filters svelte-1hp9571"><div class="search-box svelte-1hp9571"><!> <input type="text" placeholder="Buscar clientes..." class="svelte-1hp9571"/></div> <div class="filter-options svelte-1hp9571"><label class="checkbox-label svelte-1hp9571"><input type="checkbox" class="svelte-1hp9571"/> <span class="svelte-1hp9571">Mostrar inactivos</span></label></div></div> <!></div>');function ta(M,h){Ct(h,!0);let _=X(kt([])),S=X(!0),x=X(""),n=X(!1),i=X(kt({page:1,limit:30,total:0,total_pages:0}));Wt(()=>{const e=localStorage.getItem("clients_show_inactive");e!==null&&b(n,e==="true"),P()});const z=ae(e=>{t(i).page=1,P()},300);Ht(()=>{t(x),z(t(x))});async function P(){b(S,!0);try{const e=new URLSearchParams({page:t(i).page.toString(),limit:t(i).limit.toString()});t(x)&&e.append("search",t(x)),t(n)||e.append("active_only","true"),console.log("Fetching clients:",`/api/clients?${e}`);const v=await fetch(`/api/clients?${e}`);console.log("Response status:",v.status);const o=await v.json();console.log("Result:",o),v.ok?(b(_,o.clients||[],!0),b(i,o.pagination||{page:1,limit:30,total:0,total_pages:0},!0)):(Y({type:"error",message:o.message||"Error al cargar clientes"}),b(_,[],!0))}catch(e){console.error("Error loading clients:",e),Y({type:"error",message:"Error al cargar clientes"}),b(_,[],!0)}finally{b(S,!1)}}async function J(e,v,o){if(confirm(`¿Seguro que deseas eliminar a ${v} ${o}?`))try{const c=await fetch(`/api/clients/${e}`,{method:"DELETE"});if(c.ok)Y({type:"success",message:"Cliente eliminado"}),P();else{const f=await c.json();Y({type:"error",message:f.message})}}catch{Y({type:"error",message:"Error al eliminar"})}}var B=ze();Jt(e=>{Kt.title="Clientes - PAS Manager"});var D=s(B),j=r(s(D),2);Vt(j,{variant:"primary",onclick:()=>_t("/clientes/nuevo"),children:(e,v)=>{var o=ge(),c=H(o);Zt(c,{size:18}),dt(),p(e,o)},$$slots:{default:!0}}),a(D);var R=r(D,2),E=s(R),F=s(E);se(F,{size:20});var K=r(F,2);Et(K),a(E);var U=r(E,2),T=s(U),L=s(T);Et(L),L.__change=[be,n,i,P],dt(2),a(T),a(U),a(R);var O=r(R,2);{var l=e=>{var v=xe();pt(v,20,()=>Array(5),ht,(o,c)=>{re(o,{height:"60px"})}),a(v),p(e,v)},u=e=>{var v=It(),o=H(v);{var c=d=>{{let C=St(()=>t(x)?"No se encontraron resultados":"Comienza agregando tu primer cliente"),N=St(()=>t(x)?void 0:{label:"Nuevo Cliente",onclick:()=>_t("/clientes/nuevo")});te(d,{get icon(){return ne},title:"No hay clientes",get description(){return t(C)},get action(){return t(N)}})}},f=d=>{var C=Me(),N=H(C);ee(N,{children:(q,mt)=>{var ft=Ie(),gt=r(H(ft),2);pt(gt,21,()=>t(_),ht,(Tt,y)=>{var Z=Ce(),tt=s(Z),et=s(tt),Lt=s(et);a(et),a(tt);var at=r(tt),Nt=s(at);{var $t=g=>{var w=ye(),G=s(w);de(G,{size:14});var nt=r(G);a(w),A(()=>k(nt,` ${t(y).email_primary??""}`)),p(g,w)},At=g=>{var w=we();p(g,w)};I(Nt,g=>{t(y).email_primary?g($t):g(At,!1)})}a(at);var st=r(at),Bt=s(st);{var Dt=g=>{var w=Pe(),G=s(w);pe(G,{size:14});var nt=r(G);a(w),A(()=>k(nt,` ${t(y).phone??""}`)),p(g,w)},jt=g=>{var w=ke();p(g,w)};I(Bt,g=>{t(y).phone?g(Dt):g(jt,!1)})}a(st);var rt=r(st),Rt=s(rt,!0);a(rt);var ot=r(rt),bt=s(ot),xt=s(bt);le(xt,{size:14});var yt=r(xt,2),Ft=s(yt,!0);a(yt),a(bt),a(ot);var wt=r(ot),Pt=s(wt),Q=s(Pt);Q.__click=[Se,y];var Ut=s(Q);ve(Ut,{size:16}),a(Q);var it=r(Q,2);it.__click=[Ee,J,y];var qt=s(it);ce(qt,{size:16}),a(it),a(Pt),a(wt),a(Z),A(()=>{ut(et,"href",`/clientes/${t(y).id??""}`),k(Lt,`${t(y).first_name??""}
                ${t(y).last_name??""}`),k(Rt,t(y).city||"-"),k(Ft,t(y).active_policies_count||0)}),p(Tt,Z)}),a(gt),p(q,ft)},$$slots:{default:!0}});var V=r(N,2);{var zt=q=>{fe(q,{get currentPage(){return t(i).page},get totalPages(){return t(i).total_pages},get totalItems(){return t(i).total},get itemsPerPage(){return t(i).limit},$$events:{change:mt=>{t(i).page=mt.detail,P()}}})};I(V,q=>{t(i).total_pages>1&&q(zt)})}p(d,C)};I(o,d=>{t(_).length===0?d(c):d(f,!1)},!0)}p(e,v)};I(O,e=>{t(S)?e(l):e(u,!1)})}a(B),Ot(K,()=>t(x),e=>b(x,e)),Qt(L,()=>t(n),e=>b(n,e)),p(M,B),Mt()}Yt(["change","click"]);export{ta as component};
