import"../chunks/CWj6FrbW.js";import{a8 as ee,aw as L,ax as U,b,ay as ae,az as re,a as y,a9 as te,aA as se,f as S,d as s,aa as e,A as v,aE as le,aB as oe,t as ie,av as O,g as l,aC as ve,ab as de,aD as z}from"../chunks/T0dPp4D2.js";import{b as ne}from"../chunks/DmB7dAFv.js";import{g as E}from"../chunks/CdRlIqj1.js";import{B as F}from"../chunks/BpcvKk5C.js";import{I as g}from"../chunks/CCnm1ovl.js";import{S as I}from"../chunks/CeFSUsR7.js";import{C as N}from"../chunks/Ch5CQVJw.js";import{s as T}from"../chunks/C8FjytsP.js";import{A as ue}from"../chunks/DTsacfhv.js";import{S as ce}from"../chunks/CSXst1GK.js";var pe=b("<!> Volver",1),fe=b('<div class="card-header svelte-fvw11y"><h2 class="svelte-fvw11y">Información General</h2></div> <div class="form-grid svelte-fvw11y"><div class="form-group svelte-fvw11y"><label for="client_id" class="svelte-fvw11y">Cliente <span class="required svelte-fvw11y">*</span></label> <!></div> <div class="form-group svelte-fvw11y"><label for="policy_number" class="svelte-fvw11y">Número de Póliza <span class="required svelte-fvw11y">*</span></label> <!></div> <div class="form-group svelte-fvw11y"><label for="policy_type" class="svelte-fvw11y">Tipo de Seguro <span class="required svelte-fvw11y">*</span></label> <!></div> <div class="form-group svelte-fvw11y"><label for="insurer" class="svelte-fvw11y">Aseguradora <span class="required svelte-fvw11y">*</span></label> <!></div> <div class="form-group svelte-fvw11y"><label for="status" class="svelte-fvw11y">Estado</label> <!></div></div>',1),me=b('<div class="card-header svelte-fvw11y"><h2 class="svelte-fvw11y">Fechas y Montos</h2></div> <div class="form-grid svelte-fvw11y"><div class="form-group svelte-fvw11y"><label for="start_date" class="svelte-fvw11y">Fecha de Inicio <span class="required svelte-fvw11y">*</span></label> <!></div> <div class="form-group svelte-fvw11y"><label for="end_date" class="svelte-fvw11y">Fecha de Vencimiento <span class="required svelte-fvw11y">*</span></label> <!></div> <div class="form-group svelte-fvw11y"><label for="premium" class="svelte-fvw11y">Prima Anual (€) <span class="required svelte-fvw11y">*</span></label> <!></div> <div class="form-group svelte-fvw11y"><label for="coverage" class="svelte-fvw11y">Cobertura (€)</label> <!></div></div>',1),ye=b('<div class="card-header svelte-fvw11y"><h2 class="svelte-fvw11y">Notas adicionales</h2></div> <div class="form-group svelte-fvw11y"><label for="notes" class="svelte-fvw11y">Notas</label> <textarea id="notes" placeholder="Información adicional sobre la póliza..." rows="4" class="svelte-fvw11y"></textarea></div>',1),_e=b("<!> ",1),ge=b('<div class="page svelte-fvw11y"><div class="page-header svelte-fvw11y"><div class="svelte-fvw11y"><!> <h1 class="svelte-fvw11y">Editar Póliza</h1> <p class="svelte-fvw11y">Modifica los datos de la póliza</p></div></div> <form class="svelte-fvw11y"><!> <!> <!> <div class="form-actions svelte-fvw11y"><!> <!></div></form></div>');function Oe(H,o){var j,J;ee(o,!0);let w=U(!1),a=L({client_id:o.data.policy.client_id||"",policy_number:o.data.policy.policy_number||"",policy_type:o.data.policy.policy_type||"",insurer:o.data.policy.insurer||"",start_date:o.data.policy.start_date||"",end_date:o.data.policy.end_date||"",premium:((j=o.data.policy.premium)==null?void 0:j.toString())||"",coverage:((J=o.data.policy.coverage)==null?void 0:J.toString())||"",status:o.data.policy.status||"active",notes:o.data.policy.notes||""}),n=U(L({}));const K=[{value:"active",label:"Activa"},{value:"cancelled",label:"Cancelada"},{value:"expired",label:"Vencida"}],Q=[{value:"Seguro de vida",label:"Seguro de vida"},{value:"Seguro de hogar",label:"Seguro de hogar"},{value:"Seguro de auto",label:"Seguro de auto"},{value:"Seguro de salud",label:"Seguro de salud"},{value:"Seguro de negocio",label:"Seguro de negocio"},{value:"Otro",label:"Otro"}],R=le(()=>o.data.clients.map(t=>({value:t.id,label:`${t.first_name} ${t.last_name}`})));async function W(t){t.preventDefault(),z(w,!0),z(n,{},!0);try{const c=await fetch(`/api/policies/${o.data.policy.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,premium:parseFloat(a.premium)||0,coverage:parseFloat(a.coverage)||0})}),r=await c.json();c.ok?(T({type:"success",message:"Póliza actualizada exitosamente"}),E("/polizas")):(r.errors&&z(n,r.errors,!0),T({type:"error",message:r.message||"Error al actualizar póliza"}))}catch{T({type:"error",message:"Error al actualizar póliza"})}finally{z(w,!1)}}var q=ge();ae(t=>{se.title="Editar Póliza - PAS Manager"});var x=s(q),k=s(x),X=s(k);F(X,{variant:"ghost",size:"sm",onclick:()=>E("/polizas"),children:(t,c)=>{var r=pe(),i=S(r);ue(i,{size:18}),O(),y(t,r)},$$slots:{default:!0}}),O(4),l(k),l(x);var P=e(x,2),B=s(P);N(B,{children:(t,c)=>{var r=fe(),i=e(S(r),2),d=s(i),h=e(s(d),2);I(h,{id:"client_id",get options(){return v(R)},placeholder:"Selecciona un cliente",get error(){return v(n).client_id},required:!0,get value(){return a.client_id},set value(p){a.client_id=p}}),l(d);var f=e(d,2),C=e(s(f),2);g(C,{id:"policy_number",placeholder:"POL-2024-001",get error(){return v(n).policy_number},required:!0,get value(){return a.policy_number},set value(p){a.policy_number=p}}),l(f);var m=e(f,2),A=e(s(m),2);I(A,{id:"policy_type",get options(){return Q},placeholder:"Selecciona un tipo",get error(){return v(n).policy_type},required:!0,get value(){return a.policy_type},set value(p){a.policy_type=p}}),l(m);var _=e(m,2),$=e(s(_),2);g($,{id:"insurer",placeholder:"Nombre de la aseguradora",get error(){return v(n).insurer},required:!0,get value(){return a.insurer},set value(p){a.insurer=p}}),l(_);var u=e(_,2),Z=e(s(u),2);I(Z,{id:"status",get options(){return K},get error(){return v(n).status},get value(){return a.status},set value(p){a.status=p}}),l(u),l(i),y(t,r)},$$slots:{default:!0}});var D=e(B,2);N(D,{children:(t,c)=>{var r=me(),i=e(S(r),2),d=s(i),h=e(s(d),2);g(h,{id:"start_date",type:"date",get error(){return v(n).start_date},required:!0,get value(){return a.start_date},set value(u){a.start_date=u}}),l(d);var f=e(d,2),C=e(s(f),2);g(C,{id:"end_date",type:"date",get error(){return v(n).end_date},required:!0,get value(){return a.end_date},set value(u){a.end_date=u}}),l(f);var m=e(f,2),A=e(s(m),2);g(A,{id:"premium",type:"number",step:"0.01",placeholder:"0.00",get error(){return v(n).premium},required:!0,get value(){return a.premium},set value(u){a.premium=u}}),l(m);var _=e(m,2),$=e(s(_),2);g($,{id:"coverage",type:"number",step:"0.01",placeholder:"0.00",get error(){return v(n).coverage},get value(){return a.coverage},set value(u){a.coverage=u}}),l(_),l(i),y(t,r)},$$slots:{default:!0}});var G=e(D,2);N(G,{children:(t,c)=>{var r=ye(),i=e(S(r),2),d=e(s(i),2);ve(d),l(i),ne(d,()=>a.notes,h=>a.notes=h),y(t,r)},$$slots:{default:!0}});var M=e(G,2),V=s(M);F(V,{type:"button",variant:"outline",onclick:()=>E("/polizas"),get disabled(){return v(w)},children:(t,c)=>{O();var r=oe("Cancelar");y(t,r)},$$slots:{default:!0}});var Y=e(V,2);F(Y,{type:"submit",variant:"primary",get disabled(){return v(w)},children:(t,c)=>{var r=_e(),i=S(r);ce(i,{size:18});var d=e(i);ie(()=>de(d,` ${v(w)?"Guardando...":"Guardar Cambios"}`)),y(t,r)},$$slots:{default:!0}}),l(M),l(P),l(q),re("submit",P,W),y(H,q),te()}export{Oe as component};
