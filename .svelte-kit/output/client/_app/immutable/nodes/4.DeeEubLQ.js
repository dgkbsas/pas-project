import"../chunks/CWj6FrbW.js";import{o as We}from"../chunks/P-h-QmmT.js";import{c as se,f as j,a as u,af as Ye,a6 as Ze,a7 as y,a8 as me,N as b,a9 as et,ac as d,Q as r,P as n,ag as C,aa as tt,a2 as e,ab as at,ad as B,T as s,ah as $,ae as R,aD as st,ay as rt}from"../chunks/DXalFYC5.js";import{i as z}from"../chunks/DgS_HarA.js";import{s as it,r as U,c as ae,d as ge,e as we,i as ye}from"../chunks/CCesXY4h.js";import{c as lt}from"../chunks/2cUHOQ7Q.js";import{s as be}from"../chunks/CiAFSiaO.js";import"../chunks/W0raZGAH.js";import{F as nt,A as ot,a as ct,S as dt,I as vt}from"../chunks/DbJVzCiZ.js";import{E as pt}from"../chunks/BjdX1nSD.js";/* empty css                */import{C as xe,B as _t}from"../chunks/BQnzrsda.js";import{X as ut}from"../chunks/C90WgwIi.js";import"../chunks/D3fhBnoc.js";import{I as ke,s as Fe}from"../chunks/Wd1UXAwi.js";import{l as Ae,s as Me}from"../chunks/BkTacmYQ.js";import{F as ft}from"../chunks/B2p_ebVs.js";import{U as ht}from"../chunks/BtQN14_f.js";function $e(v,l){const c=Ae(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const h=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"}]];ke(v,Me({name:"activity"},()=>c,{get iconNode(){return h},children:(g,k)=>{var F=se(),A=j(F);Fe(A,l,"default",{}),u(g,F)},$$slots:{default:!0}}))}function mt(v,l){const c=Ae(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const h=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}],["path",{d:"M12 11h4"}],["path",{d:"M12 16h4"}],["path",{d:"M8 11h.01"}],["path",{d:"M8 16h.01"}]];ke(v,Me({name:"clipboard-list"},()=>c,{get iconNode(){return h},children:(g,k)=>{var F=se(),A=j(F);Fe(A,l,"default",{}),u(g,F)},$$slots:{default:!0}}))}function gt(v,l,c,h,g){d(l,e(l)==="asc"?"desc":"asc",!0),d(c,1),d(h,[],!0),g()}var wt=(v,l)=>d(l,!e(l)),yt=b('<span class="filter-badge svelte-wernd1"> </span>'),bt=b('<button class="clear-filters-btn svelte-wernd1" title="Limpiar filtros"><!> Limpiar filtros</button>'),xt=b('<span class="count-skeleton svelte-wernd1"></span>'),$t=b('<span class="count-text svelte-wernd1"> </span> <span class="count-separator svelte-wernd1">/</span> <span class="count-total svelte-wernd1"> </span>',1),kt=(v,l)=>l("types","client"),Ft=(v,l)=>l("types","policy"),At=(v,l)=>l("types","followup"),Mt=(v,l)=>l("dateFrom",v.currentTarget.value),St=(v,l)=>l("dateTo",v.currentTarget.value),zt=b('<div class="filters-panel svelte-wernd1"><div class="filter-group svelte-wernd1"><label class="filter-label svelte-wernd1" for="activity-type">Tipo de Actividad</label> <div class="filter-options svelte-wernd1"><label class="checkbox-label svelte-wernd1"><input type="checkbox" class="svelte-wernd1"/> <span class="svelte-wernd1">Clientes</span></label> <label class="checkbox-label svelte-wernd1"><input type="checkbox" class="svelte-wernd1"/> <span class="svelte-wernd1">Pólizas</span></label> <label class="checkbox-label svelte-wernd1"><input type="checkbox" class="svelte-wernd1"/> <span class="svelte-wernd1">Seguimientos</span></label></div></div> <div class="filter-group svelte-wernd1"><label class="filter-label svelte-wernd1" for="date-range">Rango de Fechas</label> <div class="date-range svelte-wernd1"><input type="date" placeholder="Desde" class="svelte-wernd1"/> <span class="svelte-wernd1">hasta</span> <input type="date" placeholder="Hasta" class="svelte-wernd1"/></div></div></div>'),Tt=b('<div class="skeleton-list svelte-wernd1"></div>'),Pt=b('<div class="activity-card svelte-wernd1"><div><!></div> <div class="activity-content svelte-wernd1"><div class="activity-header svelte-wernd1"><h3 class="activity-title svelte-wernd1"> </h3> <!></div> <p class="activity-description svelte-wernd1"> </p> <div class="activity-footer svelte-wernd1"><span class="activity-entity svelte-wernd1"> </span> <span class="activity-date svelte-wernd1"><!> </span></div></div></div>'),Ct=b('<div class="activities-list svelte-wernd1"></div> <!>',1),Lt=b('<div class="page svelte-wernd1"><div class="page-header svelte-wernd1"><div class="svelte-wernd1"><h1 class="svelte-wernd1">Actividades Recientes</h1> <p class="svelte-wernd1">Historial completo de actividad en el sistema</p></div></div> <div class="filters-toolbar svelte-wernd1"><div class="toolbar-actions svelte-wernd1"><button title="Filtros"><!> <!></button> <!> <button class="sort-btn svelte-wernd1"><!> Fecha <!></button> <div class="results-count svelte-wernd1"><!></div></div></div> <!> <!></div>');function Yt(v,l){Ze(l,!0);let c=y(me([])),h=y(!0),g=y(!1),k=y(1),F=30,A=y(0),q=y(!0),G=y(!1),Se="date",O=y("desc"),o=y(me({types:[],dateFrom:"",dateTo:""}));We(()=>{L()});async function L(t=!1){var a;t?d(g,!0):d(h,!0);try{const i=new URLSearchParams({page:e(k).toString(),limit:F.toString(),sortBy:Se,sortOrder:e(O)});e(o).types.forEach(p=>{i.append("type",p)}),e(o).dateFrom&&i.append("date_from",e(o).dateFrom),e(o).dateTo&&i.append("date_to",e(o).dateTo);const f=await fetch(`/api/activities?${i}`),_=await f.json();f.ok?(t?d(c,[...e(c),..._.activities||[]],!0):d(c,_.activities||[],!0),d(A,((a=_.pagination)==null?void 0:a.total)||0,!0),d(q,e(c).length<e(A))):(console.error("Error loading activities:",_.message),d(c,[],!0))}catch(i){console.error("Error loading activities:",i),d(c,[],!0)}finally{d(h,!1),d(g,!1)}}function ze(){!e(h)&&!e(g)&&e(q)&&(rt(k),L(!0))}function Te(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Pe(t){switch(t){case"client":return ht;case"policy":return ft;case"followup":return mt;default:return $e}}function Ce(t){switch(t){case"client":return"info";case"policy":return"success";case"followup":return"warning";default:return"default"}}function N(t,a){t==="types"?e(o).types.includes(a)?e(o).types=e(o).types.filter(i=>i!==a):e(o).types=[...e(o).types,a]:e(o)[t]=a,d(k,1),d(c,[],!0),L()}function re(){d(o,{types:[],dateFrom:"",dateTo:""},!0),d(k,1),d(c,[],!0),L()}const T=B(()=>()=>{let t=e(o).types.length;return e(o).dateFrom&&t++,e(o).dateTo&&t++,t});var J=Lt();et(t=>{at.title="Actividades - PAS Manager"});var K=n(r(J),2),ie=r(K),D=r(ie);let le;D.__click=[wt,G];var ne=r(D);nt(ne,{size:18});var Le=n(ne,2);{var Ne=t=>{var a=yt(),i=r(a,!0);s(a),C(f=>$(i,f),[()=>e(T)()]),u(t,a)};z(Le,t=>{e(T)()>0&&t(Ne)})}s(D);var oe=n(D,2);{var De=t=>{var a=bt();a.__click=re;var i=r(a);ut(i,{size:18}),R(),s(a),u(t,a)};z(oe,t=>{e(T)()>0&&t(De)})}var E=n(oe,2);E.__click=[gt,O,k,c,L];var ce=r(E);xe(ce,{size:16});var Ee=n(ce,2);{var Ie=t=>{ot(t,{size:16})},He=t=>{ct(t,{size:16})};z(Ee,t=>{e(O)==="asc"?t(Ie):t(He,!1)})}s(E);var de=n(E,2),Be=r(de);{var Re=t=>{var a=xt();u(t,a)},Ue=t=>{var a=$t(),i=j(a),f=r(i,!0);s(i);var _=n(i,4),p=r(_,!0);s(_),C(()=>{$(f,e(c).length),$(p,e(A))}),u(t,a)};z(Be,t=>{e(h)&&e(c).length===0?t(Re):t(Ue,!1)})}s(de),s(ie),s(K);var ve=n(K,2);{var je=t=>{var a=zt(),i=r(a),f=n(r(i),2),_=r(f),p=r(_);U(p),p.__change=[kt,N],R(2),s(_);var x=n(_,2),w=r(x);U(w),w.__change=[Ft,N],R(2),s(x);var Q=n(x,2),I=r(Q);U(I),I.__change=[At,N],R(2),s(Q),s(f),s(i);var m=n(i,2),V=n(r(m),2),M=r(V);U(M),M.__change=[Mt,N];var S=n(M,4);U(S),S.__change=[St,N],s(V),s(m),s(a),C((P,W,X)=>{ae(p,P),ae(w,W),ae(I,X),ge(M,e(o).dateFrom),ge(S,e(o).dateTo)},[()=>e(o).types.includes("client"),()=>e(o).types.includes("policy"),()=>e(o).types.includes("followup")]),u(t,a)};z(ve,t=>{e(G)&&t(je)})}var Oe=n(ve,2);{var Qe=t=>{var a=Tt();we(a,20,()=>Array(10),ye,(i,f)=>{dt(i,{height:"80px"})}),s(a),u(t,a)},Ve=t=>{var a=se(),i=j(a);{var f=p=>{{let x=B(()=>e(T)()>0?"No se encontraron resultados con los filtros aplicados":"Aún no hay actividad registrada en el sistema"),w=B(()=>e(T)()>0?{label:"Limpiar filtros",onclick:re}:void 0);pt(p,{get icon(){return $e},title:"No hay actividades",get description(){return e(x)},get action(){return e(w)}})}},_=p=>{var x=Ct(),w=j(x);we(w,21,()=>e(c),ye,(I,m)=>{const V=B(()=>Pe(e(m).type)),M=B(()=>Ce(e(m).type));var S=Pt(),P=r(S),W=r(P);lt(W,()=>e(V),(H,fe)=>{fe(H,{size:20})}),s(P);var X=n(P,2),Y=r(X),Z=r(Y),Xe=r(Z,!0);s(Z);var qe=n(Z,2);_t(qe,{get variant(){return e(M)},children:(H,fe)=>{R();var he=st();C(()=>$(he,e(m).type)),u(H,he)},$$slots:{default:!0}}),s(Y);var ee=n(Y,2),Ge=r(ee,!0);s(ee);var pe=n(ee,2),te=r(pe),Je=r(te,!0);s(te);var _e=n(te,2),ue=r(_e);xe(ue,{size:14});var Ke=n(ue);s(_e),s(pe),s(X),s(S),C(H=>{be(P,1,`activity-icon activity-icon-${e(M)??""}`,"svelte-wernd1"),$(Xe,e(m).title),$(Ge,e(m).description),$(Je,e(m).entity_name),$(Ke,` ${H??""}`)},[()=>Te(e(m).date)]),u(I,S)}),s(w);var Q=n(w,2);vt(Q,{get hasMore(){return e(q)},onLoadMore:ze}),u(p,x)};z(i,p=>{e(c).length===0?p(f):p(_,!1)},!0)}u(t,a)};z(Oe,t=>{e(h)?t(Qe):t(Ve,!1)})}s(J),C(t=>{le=be(D,1,"filter-btn svelte-wernd1",null,le,t),it(E,"title",e(O)==="asc"?"Ascendente":"Descendente")},[()=>({active:e(G)||e(T)()>0})]),u(v,J),tt()}Ye(["click","change"]);export{Yt as component};
