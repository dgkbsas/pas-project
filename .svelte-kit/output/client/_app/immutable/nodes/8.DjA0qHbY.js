import"../chunks/CWj6FrbW.js";import{c as Z,f as g,a as n,aW as Qe,a8 as Xe,aw as Ce,b as P,ay as Ye,a9 as Ze,aA as ea,aa as t,d as a,aD as $,A as i,ax as oe,g as e,av as U,aB as fe,t as X,ab as A,az as _e,aE as aa}from"../chunks/T0dPp4D2.js";import{i as Y}from"../chunks/iIrk5DBN.js";import{e as xe,i as Te}from"../chunks/D_uDkMHU.js";import{C as ue}from"../chunks/Ch5CQVJw.js";import{T as ta}from"../chunks/B-s6uBUg.js";import{B as he}from"../chunks/BpcvKk5C.js";import{I as T}from"../chunks/CCnm1ovl.js";import{B as sa}from"../chunks/DJIlydZI.js";import{P as ra,E as ke,T as ia}from"../chunks/BU4vvWGd.js";import{s as u}from"../chunks/C8FjytsP.js";import{U as la}from"../chunks/DTO3a6n8.js";import"../chunks/Yaf_2f41.js";import{I as De,s as Se}from"../chunks/BqsbIqZd.js";import{l as Me,s as Ne}from"../chunks/x5bn8cLp.js";import{M as ze}from"../chunks/BTHszUwG.js";import{T as oa}from"../chunks/q7TW0UXd.js";import{U as Ie}from"../chunks/CZE326ez.js";function na(B,l){const c=Me(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const k=[["path",{d:"M10 12h4"}],["path",{d:"M10 8h4"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16"}]];De(B,Ne({name:"building-2"},()=>c,{get iconNode(){return k},children:(z,R)=>{var L=Z(),d=g(L);Se(d,l,"default",{}),n(z,L)},$$slots:{default:!0}}))}function va(B,l){const c=Me(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const k=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];De(B,Ne({name:"copy"},()=>c,{get iconNode(){return k},children:(z,R)=>{var L=Z(),d=g(L);Se(d,l,"default",{}),n(z,L)},$$slots:{default:!0}}))}var da=P('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Perfil de Usuario</h2> <p class="svelte-6qgtij">Actualiza tu información personal y contraseña</p></div></div> <form class="svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group full-width svelte-6qgtij"><label class="svelte-6qgtij">Email</label> <!> <small class="help-text svelte-6qgtij">El email no se puede cambiar</small></div> <div class="form-group svelte-6qgtij"><label class="svelte-6qgtij">Nueva Contraseña</label> <!></div> <div class="form-group svelte-6qgtij"><label class="svelte-6qgtij">Confirmar Contraseña</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!></div></form>',1),ca=P('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Datos de la Empresa</h2> <p class="svelte-6qgtij">Información de tu empresa u organización</p></div></div> <form class="svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group full-width svelte-6qgtij"><label class="svelte-6qgtij">Nombre de la Empresa</label> <!></div> <div class="form-group full-width svelte-6qgtij"><label class="svelte-6qgtij">Dirección</label> <!></div> <div class="form-group svelte-6qgtij"><label class="svelte-6qgtij">Ciudad</label> <!></div> <div class="form-group svelte-6qgtij"><label class="svelte-6qgtij">Código Postal</label> <!></div> <div class="form-group svelte-6qgtij"><label class="svelte-6qgtij">Teléfono</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!></div></form>',1),ua=P("<!> ",1),pa=(B,l,c)=>l(i(c).token),ma=(B,l,c)=>l(i(c).id),ga=P('<div class="invitation-item svelte-6qgtij"><div class="invitation-info svelte-6qgtij"><div class="invitation-email svelte-6qgtij"> </div> <div class="invitation-meta svelte-6qgtij"> </div></div> <div class="invitation-actions svelte-6qgtij"><button class="action-btn svelte-6qgtij" title="Copiar link"><!></button> <button class="action-btn danger svelte-6qgtij" title="Eliminar"><!></button></div></div>'),fa=P('<div class="invitations-list svelte-6qgtij"></div>'),_a=P('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Invitaciones</h2> <p class="svelte-6qgtij">Invita a nuevos usuarios a unirse a tu empresa</p></div></div> <form class="invite-form svelte-6qgtij"><div class="invite-inputs svelte-6qgtij"><!> <!></div></form> <!>',1),ha=P('<tr class="svelte-6qgtij"><td class="svelte-6qgtij"> </td><td class="svelte-6qgtij"><!></td><td class="svelte-6qgtij"> </td></tr>'),ya=P('<thead class="svelte-6qgtij"><tr class="svelte-6qgtij"><th class="svelte-6qgtij">Email</th><th class="svelte-6qgtij">Rol</th><th class="svelte-6qgtij">Fecha de Registro</th></tr></thead> <tbody class="svelte-6qgtij"></tbody>',1),ja=P('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Usuarios</h2> <p class="svelte-6qgtij">Usuarios con acceso a la empresa</p></div></div> <!>',1),qa=P('<div class="page svelte-6qgtij"><div class="page-header svelte-6qgtij"><div class="svelte-6qgtij"><h1 class="svelte-6qgtij">Configuración</h1> <p class="svelte-6qgtij">Administra la configuración de tu empresa y perfil</p></div></div> <!></div>');function Oa(B,l){var je,qe,be,we,$e;Xe(l,!0);let c=oe("profile"),k=oe(!1),z=oe(!1),R=oe(!1);const L=[{id:"profile",label:"Perfil"},{id:"company",label:"Empresa"},{id:"invitations",label:"Invitaciones"},{id:"users",label:"Usuarios"}];let d=Ce({email:l.data.user.email||"",current_password:"",new_password:"",confirm_password:""}),f=Ce({name:((je=l.data.company)==null?void 0:je.name)||"",address:((qe=l.data.company)==null?void 0:qe.address)||"",city:((be=l.data.company)==null?void 0:be.city)||"",postal_code:((we=l.data.company)==null?void 0:we.postal_code)||"",phone:(($e=l.data.company)==null?void 0:$e.phone)||""}),ne=oe(""),Ue="user";async function Ae(){$(k,!0);try{const s={};if(d.new_password){if(d.new_password!==d.confirm_password){u({type:"error",message:"Las contraseñas no coinciden"});return}s.password=d.new_password}if(Object.keys(s).length>0){const p=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(p.ok)u({type:"success",message:"Perfil actualizado"}),d.current_password="",d.new_password="",d.confirm_password="";else{const G=await p.json();u({type:"error",message:G.message})}}}catch{u({type:"error",message:"Error al actualizar perfil"})}finally{$(k,!1)}}async function Be(){$(z,!0);try{const s=await fetch("/api/company",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(s.ok)u({type:"success",message:"Empresa actualizada"});else{const p=await s.json();u({type:"error",message:p.message})}}catch{u({type:"error",message:"Error al actualizar empresa"})}finally{$(z,!1)}}async function Le(){$(R,!0);try{const s=await fetch("/api/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i(ne),role:Ue})});if(s.ok)u({type:"success",message:"Invitación enviada"}),$(ne,""),window.location.reload();else{const p=await s.json();u({type:"error",message:p.message})}}catch{u({type:"error",message:"Error al enviar invitación"})}finally{$(R,!1)}}async function Oe(s){if(confirm("¿Seguro que deseas eliminar esta invitación?"))try{const p=await fetch(`/api/invitations/${s}`,{method:"DELETE"});if(p.ok)u({type:"success",message:"Invitación eliminada"}),window.location.reload();else{const G=await p.json();u({type:"error",message:G.message})}}catch{u({type:"error",message:"Error al eliminar"})}}function Re(s){const p=`${window.location.origin}/auth/signup?token=${s}`;navigator.clipboard.writeText(p),u({type:"success",message:"Link copiado al portapapeles"})}function ye(s){return new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}function Ge(s){return"default"}function Je(s){return s==="admin"?"Administrador":"Usuario"}var pe=qa();Ye(s=>{ea.title="Configuración - PAS Manager"});var Ve=t(a(pe),2);ta(Ve,{get tabs(){return L},get activeTab(){return i(c)},set activeTab(s){$(c,s,!0)},$$events:{change:s=>$(c,s.detail,!0)},children:(s,p)=>{var G=Z(),Fe=g(G);{var He=J=>{ue(J,{children:(ve,Pe)=>{var de=da(),ee=g(de),E=a(ee),V=a(E);la(V,{size:20}),e(E),U(2),e(ee);var F=t(ee,2),I=a(F),C=a(I),_=t(a(C),2);T(_,{get value(){return d.email},disabled:!0}),U(2),e(C);var b=t(C,2),D=t(a(b),2);T(D,{type:"password",placeholder:"Dejar en blanco para no cambiar",get value(){return d.new_password},set value(v){d.new_password=v}}),e(b);var h=t(b,2),m=t(a(h),2);T(m,{type:"password",placeholder:"Confirmar nueva contraseña",get value(){return d.confirm_password},set value(v){d.confirm_password=v}}),e(h),e(I);var x=t(I,2),S=a(x);he(S,{type:"submit",variant:"primary",get disabled(){return i(k)},children:(v,y)=>{U();var w=fe();X(()=>A(w,i(k)?"Guardando...":"Guardar Cambios")),n(v,w)},$$slots:{default:!0}}),e(x),e(F),_e("submit",F,v=>{v.preventDefault(),Ae()}),n(ve,de)},$$slots:{default:!0}})},We=J=>{var ve=Z(),Pe=g(ve);{var de=E=>{ue(E,{children:(V,F)=>{var I=ca(),C=g(I),_=a(C),b=a(_);na(b,{size:20}),e(_),U(2),e(C);var D=t(C,2),h=a(D),m=a(h),x=t(a(m),2);T(x,{placeholder:"Mi Empresa S.A.",required:!0,get value(){return f.name},set value(o){f.name=o}}),e(m);var S=t(m,2),v=t(a(S),2);T(v,{placeholder:"Calle Principal 123",get value(){return f.address},set value(o){f.address=o}}),e(S);var y=t(S,2),w=t(a(y),2);T(w,{placeholder:"Madrid",get value(){return f.city},set value(o){f.city=o}}),e(y);var O=t(y,2),ae=t(a(O),2);T(ae,{placeholder:"28001",get value(){return f.postal_code},set value(o){f.postal_code=o}}),e(O);var H=t(O,2),te=t(a(H),2);T(te,{type:"tel",placeholder:"+34 900 000 000",get value(){return f.phone},set value(o){f.phone=o}}),e(H),e(h);var r=t(h,2),M=a(r);he(M,{type:"submit",variant:"primary",get disabled(){return i(z)},children:(o,j)=>{U();var q=fe();X(()=>A(q,i(z)?"Guardando...":"Guardar Cambios")),n(o,q)},$$slots:{default:!0}}),e(r),e(D),_e("submit",D,o=>{o.preventDefault(),Be()}),n(V,I)},$$slots:{default:!0}})},ee=E=>{var V=Z(),F=g(V);{var I=_=>{ue(_,{children:(b,D)=>{var h=_a(),m=g(h),x=a(m),S=a(x);ze(S,{size:20}),e(x),U(2),e(m);var v=t(m,2),y=a(v),w=a(y);T(w,{type:"email",placeholder:"correo@ejemplo.com",required:!0,get value(){return i(ne)},set value(r){$(ne,r,!0)}});var O=t(w,2);he(O,{type:"submit",variant:"primary",get disabled(){return i(R)},children:(r,M)=>{var o=ua(),j=g(o);ra(j,{size:18});var q=t(j);X(()=>A(q,` ${i(R)?"Enviando...":"Enviar Invitación"}`)),n(r,o)},$$slots:{default:!0}}),e(y),e(v);var ae=t(v,2);{var H=r=>{ke(r,{get icon(){return ze},title:"Sin invitaciones",description:"No hay invitaciones pendientes"})},te=r=>{var M=fa();xe(M,21,()=>l.data.invitations,Te,(o,j)=>{var q=ga(),se=a(q),N=a(se),re=a(N,!0);e(N);var W=t(N,2),me=a(W);e(W),e(se);var K=t(se,2),Q=a(K);Q.__click=[pa,Re,j];var ce=a(Q);va(ce,{size:16}),e(Q);var ie=t(Q,2);ie.__click=[ma,Oe,j];var le=a(ie);oa(le,{size:16}),e(ie),e(K),e(q),X(ge=>{A(re,i(j).email),A(me,`Enviada ${ge??""}`)},[()=>ye(i(j).created_at)]),n(o,q)}),e(M),n(r,M)};Y(ae,r=>{l.data.invitations.length===0?r(H):r(te,!1)})}_e("submit",v,r=>{r.preventDefault(),Le()}),n(b,h)},$$slots:{default:!0}})},C=_=>{var b=Z(),D=g(b);{var h=m=>{ue(m,{children:(x,S)=>{var v=ja(),y=g(v),w=a(y),O=a(w);Ie(O,{size:20}),e(w),U(2),e(y);var ae=t(y,2);{var H=r=>{ke(r,{get icon(){return Ie},title:"Sin usuarios",description:"No hay usuarios registrados"})},te=r=>{ia(r,{children:(M,o)=>{var j=ya(),q=t(g(j),2);xe(q,21,()=>l.data.users,Te,(se,N)=>{var re=ha(),W=a(re),me=a(W,!0);e(W);var K=t(W),Q=a(K);{let le=aa(()=>Ge(i(N).role));sa(Q,{get variant(){return i(le)},children:(ge,ba)=>{U();var Ee=fe();X(Ke=>A(Ee,Ke),[()=>Je(i(N).role)]),n(ge,Ee)},$$slots:{default:!0}})}e(K);var ce=t(K),ie=a(ce,!0);e(ce),e(re),X(le=>{A(me,i(N).email),A(ie,le)},[()=>ye(i(N).created_at)]),n(se,re)}),e(q),n(M,j)},$$slots:{default:!0}})};Y(ae,r=>{l.data.users.length===0?r(H):r(te,!1)})}n(x,v)},$$slots:{default:!0}})};Y(D,m=>{i(c)==="users"&&m(h)},!0)}n(_,b)};Y(F,_=>{i(c)==="invitations"?_(I):_(C,!1)},!0)}n(E,V)};Y(Pe,E=>{i(c)==="company"?E(de):E(ee,!1)},!0)}n(J,ve)};Y(Fe,J=>{i(c)==="profile"?J(He):J(We,!1)})}n(s,G)},$$slots:{default:!0}}),e(pe),n(B,pe),Ze()}Qe(["click"]);export{Oa as component};
