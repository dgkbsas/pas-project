import"../chunks/CWj6FrbW.js";import{c as ce,f as $,a as r,af as Ua,a6 as Oa,a7 as N,a8 as Oe,ac as l,a2 as e,N as u,Q as t,T as a,aa as Va,P as s,ae as J,aD as _e,ag as R,ah as A,o as Sa,a9 as et,ab as at,aE as da,ad as tt}from"../chunks/DXalFYC5.js";import{i as E}from"../chunks/DgS_HarA.js";import{e as aa,r as st,s as rt,i as ma}from"../chunks/CCesXY4h.js";import{C as Ve}from"../chunks/DD2hwmqD.js";import{T as it,S as ot}from"../chunks/CsaozLtE.js";import{B as Ie}from"../chunks/ey38HHQe.js";import{I as K}from"../chunks/DYUOFKwE.js";import{C as lt,B as fa}from"../chunks/BQnzrsda.js";import{P as pa,T as Na}from"../chunks/BE3yFpjr.js";import{E as wa}from"../chunks/BjdX1nSD.js";import{s as v}from"../chunks/ejPKeNiZ.js";import{o as nt}from"../chunks/P-h-QmmT.js";import{c as vt}from"../chunks/2cUHOQ7Q.js";import{s as Aa}from"../chunks/CiAFSiaO.js";import{a as ct}from"../chunks/Bf-8v-H5.js";import"../chunks/D3fhBnoc.js";import{I as Ea,s as Ca}from"../chunks/Wd1UXAwi.js";import{l as xa,s as Pa}from"../chunks/BkTacmYQ.js";import{F as dt}from"../chunks/B2p_ebVs.js";import{C as Da,P as ut,T as ka}from"../chunks/CSUxE8_x.js";import{X as mt}from"../chunks/C90WgwIi.js";import{U as ft}from"../chunks/DGbCUdBR.js";import{M as Ma}from"../chunks/CfGZx9bz.js";import{U as La}from"../chunks/BtQN14_f.js";function ua(V,c){const d=xa(c,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const C=[["path",{d:"M10 12h4"}],["path",{d:"M10 8h4"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16"}]];Ea(V,Pa({name:"building-2"},()=>d,{get iconNode(){return C},children:(H,X)=>{var D=ce(),x=$(D);Ca(x,c,"default",{}),r(H,D)},$$slots:{default:!0}}))}function pt(V,c){const d=xa(c,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const C=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Ea(V,Pa({name:"copy"},()=>d,{get iconNode(){return C},children:(H,X)=>{var D=ce(),x=$(D);Ca(x,c,"default",{}),r(H,D)},$$slots:{default:!0}}))}function gt(V,c){const d=xa(c,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const C=[["line",{x1:"12",x2:"12",y1:"2",y2:"22"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"}]];Ea(V,Pa({name:"dollar-sign"},()=>d,{get iconNode(){return C},children:(H,X)=>{var D=ce(),x=$(D);Ca(x,c,"default",{}),r(H,D)},$$slots:{default:!0}}))}function _t(V,c,d){l(c,null),l(d,"")}var ht=u('<div class="loading-state svelte-131nf9n"><p class="svelte-131nf9n">Cargando configuraciones...</p></div>'),yt=u('<div class="show-inactive-toggle svelte-131nf9n"><label class="checkbox-label svelte-131nf9n"><input type="checkbox" class="svelte-131nf9n"/> <span class="svelte-131nf9n">Mostrar items inactivos</span></label></div>'),bt=(V,c,d,C)=>c(e(d).key,e(C).key),jt=u('<div class="item-edit-form svelte-131nf9n"><!> <div class="item-actions svelte-131nf9n"><button class="action-btn success svelte-131nf9n" title="Guardar"><!></button> <button class="action-btn svelte-131nf9n" title="Cancelar"><!></button></div></div>'),qt=(V,c,d,C)=>c(e(d).key,e(C).key),$t=(V,c,d,C)=>c(e(d).key,e(C).key),wt=u('<div class="item-content svelte-131nf9n"><div class="item-label-wrapper svelte-131nf9n"><span class="item-label svelte-131nf9n"> </span> <!></div> <code class="item-value svelte-131nf9n"> </code></div> <div class="item-actions svelte-131nf9n"><button class="action-btn svelte-131nf9n" title="Editar"><!></button> <button><!></button></div>',1),kt=u("<div><!></div>"),Et=u('<div class="empty-state svelte-131nf9n"><p class="svelte-131nf9n"><!></p></div>'),Ct=u("<!> Agregar",1),xt=u('<div class="add-item-input svelte-131nf9n"><!> <!> <!></div>'),Pt=u("<!> ",1),zt=u('<div class="section-header svelte-131nf9n"><div class="section-title svelte-131nf9n"><div class="icon-wrapper svelte-131nf9n"><!></div> <div class="svelte-131nf9n"><h3 class="svelte-131nf9n"> </h3> <p class="section-description svelte-131nf9n"> </p></div></div> <div style="display: flex; gap: var(--space-2); align-items: center;" class="svelte-131nf9n"><!> <!></div></div> <!> <div class="items-list svelte-131nf9n"><!> <!></div> <div class="add-item-form svelte-131nf9n"><!></div>',1),It=u(`<div class="help-content svelte-131nf9n"><h4 class="svelte-131nf9n">💡 Acerca de la configuración</h4> <ul class="svelte-131nf9n"><li class="svelte-131nf9n"><strong class="svelte-131nf9n">Valor automático:</strong> Al agregar un item, se genera automáticamente
              un valor técnico (slug) sin espacios ni acentos para uso interno en
              la base de datos</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Edición del nombre:</strong> Puedes cambiar el nombre visible
              sin afectar el valor técnico, manteniendo la compatibilidad con datos
              existentes</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Desactivación:</strong> En lugar de eliminar, los items se
              desactivan para preservar el historial. Las pólizas existentes mantienen
              su referencia</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Items inactivos:</strong> Los items desactivados no aparecen
              en los formularios nuevos, pero puedes verlos activando el checkbox
              "Mostrar items inactivos"</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Reactivación:</strong> Puedes reactivar items desactivados
              en cualquier momento haciendo clic en el botón de activar (✓)</li></ul></div>`),Tt=u('<div class="sections-grid svelte-131nf9n"></div> <div class="help-section svelte-131nf9n"><!></div>',1),St=u('<div class="config-manager svelte-131nf9n"><!></div>');function Nt(V,c){Oa(c,!0);let d=N(!1),C=N(Oe([{key:"payment_modes",label:"Modos de Pago",icon:gt,description:"Modalidades de pago disponibles para las pólizas",items:[]},{key:"policy_types",label:"Tipos de Póliza",icon:dt,description:"Tipos de pólizas de seguro que se pueden crear",items:[]},{key:"followup_types",label:"Tipos de Seguimiento",icon:lt,description:"Categorías de seguimientos para las pólizas",items:[]}])),H=N(null),X=N(""),D=N(""),x=N(null),B=N(!1);nt(async()=>{await qe()});async function qe(){l(d,!0);try{const m=await fetch("/api/config"),h=await m.json();m.ok&&h.config&&l(C,e(C).map(w=>{const U=h.config[w.key]||[];return{...w,items:U}}),!0)}catch(m){console.error("Error loading configurations:",m),v({type:"error",message:"Error al cargar configuraciones"})}finally{l(d,!1)}}async function Be(m){if(!e(X).trim()){v({type:"error",message:"El nombre no puede estar vacío"});return}const h=e(C).find(w=>w.key===m);if(h){if(h.items.some(w=>w.value.toLowerCase()===e(X).trim().toLowerCase())){v({type:"error",message:"Este item ya existe"});return}try{const w=await fetch(`/api/config/${m}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:e(X).trim(),active:!0})});if(w.ok)v({type:"success",message:"Item agregado exitosamente"}),await qe(),l(X,""),l(x,null);else{const U=await w.json();v({type:"error",message:U.message||"Error al agregar item"})}}catch{v({type:"error",message:"Error al agregar item"})}}}async function he(m,h){if(!e(D).trim()){v({type:"error",message:"El nombre no puede estar vacío"});return}const w=e(C).find(T=>T.key===m);if(!w)return;const U=w.items.find(T=>T.key===h);if(U){if(w.items.some(T=>T.key!==h&&T.value.toLowerCase()===e(D).trim().toLowerCase())){v({type:"error",message:"Este item ya existe"});return}try{const T=await fetch(`/api/config/${m}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:h,value:e(D).trim(),active:U.active})});if(T.ok)v({type:"success",message:"Item actualizado exitosamente"}),await qe(),l(H,null),l(D,"");else{const W=await T.json();v({type:"error",message:W.message||"Error al actualizar item"})}}catch{v({type:"error",message:"Error al actualizar item"})}}}async function Q(m,h){const w=e(C).find(W=>W.key===m);if(!w)return;const U=w.items.find(W=>W.key===h);if(!U)return;const T=U.active?"desactivar":"activar";if(confirm(`¿Seguro que deseas ${T} "${U.value}"?`))try{const W=await fetch(`/api/config/${m}?itemKey=${h}`,{method:"DELETE"});if(W.ok){const j=await W.json();v({type:"success",message:j.message}),await qe()}else{const j=await W.json();v({type:"error",message:j.message||"Error al cambiar estado"})}}catch{v({type:"error",message:"Error al cambiar estado del item"})}}function ta(m,h){const w=e(C).find(T=>T.key===m);if(!w)return;const U=w.items.find(T=>T.key===h);U&&(l(H,{sectionKey:m,itemKey:h},!0),l(D,U.value,!0))}function Xe(m){return e(B)?m:m.filter(h=>h.active)}function Fe(m){return m.filter(h=>h.active).length}function Te(m){return m.filter(h=>!h.active).length}var Qe=St(),ga=t(Qe);{var _a=m=>{var h=ht();r(m,h)},ha=m=>{var h=Tt(),w=$(h);aa(w,21,()=>e(C),ma,(W,j)=>{Ve(W,{children:(We,ya)=>{var sa=zt(),Se=$(sa),Ze=t(Se),Ge=t(Ze),ra=t(Ge);{var ia=n=>{var o=ce(),f=$(o);vt(f,()=>e(j).icon,(p,y)=>{y(p,{size:20})}),r(n,o)};E(ra,n=>{e(j).icon&&n(ia)})}a(Ge);var Ye=s(Ge,2),Je=t(Ye),i=t(Je,!0);a(Je);var _=s(Je,2),ee=t(_,!0);a(_),a(Ye),a(Ze);var we=s(Ze,2),oa=t(we);fa(oa,{variant:"success",children:(n,o)=>{J();var f=_e();R(p=>A(f,`${p??""} activos`),[()=>Fe(e(j).items)]),r(n,f)},$$slots:{default:!0}});var ba=s(oa,2);{var ke=n=>{fa(n,{variant:"default",children:(o,f)=>{J();var p=_e();R(y=>A(p,`${y??""} inactivos`),[()=>Te(e(j).items)]),r(o,p)},$$slots:{default:!0}})};E(ba,n=>{Te(e(j).items)>0&&n(ke)})}a(we),a(Se);var Ne=s(Se,2);{var la=n=>{var o=yt(),f=t(o),p=t(f);st(p),J(2),a(f),a(o),ct(p,()=>e(B),y=>l(B,y)),r(n,o)};E(Ne,n=>{Te(e(j).items)>0&&n(la)})}var Ee=s(Ne,2),Ce=t(Ee);aa(Ce,17,()=>Xe(e(j).items),n=>n.key,(n,o)=>{var f=kt();let p;var y=t(f);{var k=b=>{var P=jt(),S=t(P);K(S,{placeholder:"Nombre del item",autofocus:!0,get value(){return e(D)},set value(z){l(D,z,!0)}});var F=s(S,2),Z=t(F);Z.__click=[bt,he,j,o];var ae=t(Z);Da(ae,{size:16}),a(Z);var O=s(Z,2);O.__click=[_t,H,D];var te=t(O);mt(te,{size:16}),a(O),a(F),a(P),r(b,P)},q=b=>{var P=wt(),S=$(P),F=t(S),Z=t(F),ae=t(Z,!0);a(Z);var O=s(Z,2);{var te=M=>{fa(M,{variant:"default",children:(g,L)=>{J();var Y=_e("Inactivo");r(g,Y)},$$slots:{default:!0}})};E(O,M=>{e(o).active||M(te)})}a(F);var z=s(F,2),le=t(z,!0);a(z),a(S);var se=s(S,2),re=t(se);re.__click=[qt,ta,j,o];var Pe=t(re);ut(Pe,{size:16}),a(re);var pe=s(re,2);pe.__click=[$t,Q,j,o];var Ae=t(pe);{var De=M=>{ka(M,{size:16})},I=M=>{Da(M,{size:16})};E(Ae,M=>{e(o).active?M(De):M(I,!1)})}a(pe),a(se),R(()=>{A(ae,e(o).value),A(le,e(o).key),re.disabled=!e(o).active,Aa(pe,1,`action-btn ${e(o).active?"warning":"success"}`,"svelte-131nf9n"),rt(pe,"title",e(o).active?"Desactivar":"Activar")}),r(b,P)};E(y,b=>{var P,S;((P=e(H))==null?void 0:P.sectionKey)===e(j).key&&((S=e(H))==null?void 0:S.itemKey)===e(o).key?b(k):b(q,!1)})}a(f),R(b=>p=Aa(f,1,"item-row svelte-131nf9n",null,p,b),[()=>({inactive:!e(o).active})]),r(n,f)});var me=s(Ce,2);{var xe=n=>{var o=Et(),f=t(o),p=t(f);{var y=q=>{var b=_e();R(P=>A(b,`No hay items activos. Hay ${P??""} items
                    inactivos.`),[()=>Te(e(j).items)]),r(q,b)},k=q=>{var b=_e("No hay items configurados");r(q,b)};E(p,q=>{Te(e(j).items)>0?q(y):q(k,!1)})}a(f),a(o),r(n,o)};E(me,n=>{Xe(e(j).items).length===0&&!e(B)&&n(xe)})}a(Ee);var $e=s(Ee,2),ye=t($e);{var fe=n=>{var o=xt(),f=t(o);K(f,{placeholder:"Nombre del nuevo item",autofocus:!0,onkeydown:k=>{k.key==="Enter"?(k.preventDefault(),Be(e(j).key)):k.key==="Escape"&&(l(x,null),l(X,""))},get value(){return e(X)},set value(k){l(X,k,!0)}});var p=s(f,2);Ie(p,{variant:"primary",size:"sm",onclick:()=>Be(e(j).key),children:(k,q)=>{var b=Ct(),P=$(b);pa(P,{size:16}),J(),r(k,b)},$$slots:{default:!0}});var y=s(p,2);Ie(y,{variant:"ghost",size:"sm",onclick:()=>{l(x,null),l(X,"")},children:(k,q)=>{J();var b=_e("Cancelar");r(k,b)},$$slots:{default:!0}}),a(o),r(n,o)},oe=n=>{Ie(n,{variant:"outline",size:"sm",onclick:()=>l(x,e(j).key,!0),children:(o,f)=>{var p=Pt(),y=$(p);pa(y,{size:16});var k=s(y);R(()=>A(k,` Agregar ${e(j).label??""}`)),r(o,p)},$$slots:{default:!0}})};E(ye,n=>{e(x)===e(j).key?n(fe):n(oe,!1)})}a($e),R(()=>{A(i,e(j).label),A(ee,e(j).description)}),r(We,sa)},$$slots:{default:!0}})}),a(w);var U=s(w,2),T=t(U);Ve(T,{children:(W,j)=>{var We=It();r(W,We)},$$slots:{default:!0}}),a(U),r(m,h)};E(ga,m=>{e(d)?m(_a):m(ha,!1)})}a(Qe),r(V,Qe),Va()}Ua(["click"]);var At=u('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Perfil de Usuario</h2> <p class="svelte-6qgtij">Actualiza tu información personal y contraseña</p></div></div> <form class="svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group double-width svelte-6qgtij"><label for="email" class="svelte-6qgtij">Email</label> <!> <small class="help-text svelte-6qgtij">El email no se puede cambiar</small></div> <div class="form-group svelte-6qgtij"><label for="new_password" class="svelte-6qgtij">Nueva Contraseña</label> <!></div> <div class="form-group svelte-6qgtij"><label for="confirm_password" class="svelte-6qgtij">Confirmar Contraseña</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!></div></form>',1),Dt=u('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Datos de la Empresa</h2> <p class="svelte-6qgtij">Información de tu empresa u organización</p></div></div> <form class="svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group double-width svelte-6qgtij"><label for="companyName" class="svelte-6qgtij">Nombre de la Empresa</label> <!></div> <div class="form-group double-width svelte-6qgtij"><label for="companyAddress" class="svelte-6qgtij">Dirección</label> <!></div> <div class="form-group svelte-6qgtij"><label for="companyCity" class="svelte-6qgtij">Ciudad</label> <!></div> <div class="form-group svelte-6qgtij"><label for="companyPostalCode" class="svelte-6qgtij">Código Postal</label> <!></div> <div class="form-group svelte-6qgtij"><label for="companyPhone" class="svelte-6qgtij">Teléfono</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!></div></form>',1),Mt=u("<!> Crear Aseguradora",1),Lt=u('<div class="loading-text svelte-6qgtij">Cargando aseguradoras...</div>'),Ut=u('<span class="code-badge svelte-6qgtij"> </span>'),Ot=u('<span class="text-muted svelte-6qgtij">-</span>'),Vt=u('<span class="contact-info svelte-6qgtij"> </span>'),Bt=u('<span class="contact-info svelte-6qgtij"> </span>'),Ft=u('<span class="text-muted svelte-6qgtij">Sin contacto</span>'),Gt=(V,c,d)=>c(e(d)),Jt=(V,c,d)=>c(e(d).id,e(d).name),Rt=u('<tr class="svelte-6qgtij"><td class="svelte-6qgtij"><div class="insurer-name svelte-6qgtij"><!> </div></td><td class="svelte-6qgtij"><!></td><td class="svelte-6qgtij"><!></td><td class="text-right svelte-6qgtij"><div class="table-actions svelte-6qgtij"><button class="action-btn svelte-6qgtij" title="Editar"><!></button> <button class="action-btn danger svelte-6qgtij" title="Eliminar"><!></button></div></td></tr>'),Ht=u('<thead class="svelte-6qgtij"><tr class="svelte-6qgtij"><th class="svelte-6qgtij">Nombre</th><th class="svelte-6qgtij">Código</th><th class="svelte-6qgtij">Contacto</th><th class="text-right svelte-6qgtij">Acciones</th></tr></thead> <tbody class="svelte-6qgtij"></tbody>',1),Xt=u('<div class="insurers-table svelte-6qgtij"><!></div>'),Qt=u('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Compañías de Seguros</h2> <p class="svelte-6qgtij">Gestiona las aseguradoras disponibles en el sistema</p></div></div> <form class="insurer-form svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group svelte-6qgtij"><label for="insurerName" class="svelte-6qgtij">Nombre *</label> <!></div> <div class="form-group svelte-6qgtij"><label for="insurerCode" class="svelte-6qgtij">Código</label> <!></div> <div class="form-group svelte-6qgtij"><label for="insurerContactEmail" class="svelte-6qgtij">Email de contacto</label> <!></div> <div class="form-group svelte-6qgtij"><label for="insurerContactPhone" class="svelte-6qgtij">Teléfono</label> <!></div> <div class="form-group full-width svelte-6qgtij"><label for="insurerWebsite" class="svelte-6qgtij">Sitio web</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!> <!></div></form> <!>',1),Wt=u("<!> ",1),Zt=(V,c,d)=>c(e(d).token),Yt=(V,c,d)=>c(e(d).id),Kt=u('<div class="invitation-item svelte-6qgtij"><div class="invitation-info svelte-6qgtij"><div class="invitation-email svelte-6qgtij"> </div> <div class="invitation-meta svelte-6qgtij"> </div></div> <div class="invitation-actions svelte-6qgtij"><button class="action-btn svelte-6qgtij" title="Copiar link"><!></button> <button class="action-btn danger svelte-6qgtij" title="Eliminar"><!></button></div></div>'),es=u('<div class="invitations-list svelte-6qgtij"></div>'),as=u('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Invitaciones</h2> <p class="svelte-6qgtij">Invita a nuevos usuarios a unirse a tu empresa</p></div></div> <form class="invite-form svelte-6qgtij"><div class="invite-inputs svelte-6qgtij"><!> <!></div></form> <!>',1),ts=u('<tr class="svelte-6qgtij"><td class="svelte-6qgtij"> </td><td class="svelte-6qgtij"><!></td><td class="svelte-6qgtij"> </td></tr>'),ss=u('<thead class="svelte-6qgtij"><tr class="svelte-6qgtij"><th class="svelte-6qgtij">Email</th><th class="svelte-6qgtij">Rol</th><th class="svelte-6qgtij">Fecha de Registro</th></tr></thead> <tbody class="svelte-6qgtij"></tbody>',1),rs=u('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Usuarios</h2> <p class="svelte-6qgtij">Usuarios con acceso a la empresa</p></div></div> <!>',1),is=u('<div class="page svelte-6qgtij"><div class="page-header svelte-6qgtij"><div class="svelte-6qgtij"><h1 class="svelte-6qgtij">Configuración</h1> <p class="svelte-6qgtij">Administra la configuración de tu empresa y perfil</p></div></div> <!></div>');function Is(V,c){var Ge,ra,ia,Ye,Je;Oa(c,!0);let d=N("profile"),C=N(!1),H=N(!1),X=N(!1);const D=[{id:"profile",label:"Perfil"},{id:"company",label:"Empresa"},{id:"insurers",label:"Aseguradoras"},{id:"variables",label:"Variables"},{id:"invitations",label:"Invitaciones"},{id:"users",label:"Usuarios"}];let x=Oe({email:c.data.user.email||"",current_password:"",new_password:"",confirm_password:""}),B=N(Oe({name:((Ge=c.data.company)==null?void 0:Ge.name)||"",address:((ra=c.data.company)==null?void 0:ra.address)||"",city:((ia=c.data.company)==null?void 0:ia.city)||"",postal_code:((Ye=c.data.company)==null?void 0:Ye.postal_code)||"",phone:((Je=c.data.company)==null?void 0:Je.phone)||""})),qe=N(Oe([])),Be=N(!1),he=N(null),Q=N(Oe({name:"",code:"",contact_email:"",contact_phone:"",website:""})),ta=N(Oe([])),Xe=N(!1);N(Oe({config_key:"",config_value:""}));let Fe=N(""),Te="user";async function Qe(){l(C,!0);try{const i={};if(x.new_password){if(x.new_password!==x.confirm_password){v({type:"error",message:"Las contraseñas no coinciden"});return}i.password=x.new_password}if(Object.keys(i).length>0){const _=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(_.ok)v({type:"success",message:"Perfil actualizado"}),x.current_password="",x.new_password="",x.confirm_password="";else{const ee=await _.json();v({type:"error",message:ee.message})}}}catch{v({type:"error",message:"Error al actualizar perfil"})}finally{l(C,!1)}}async function ga(){l(H,!0);try{const i=await fetch("/api/company",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(B))}),_=await i.json();i.ok?(v({type:"success",message:"Empresa actualizada"}),_.company&&l(B,{name:_.company.name||"",address:_.company.address||"",city:_.company.city||"",postal_code:_.company.postal_code||"",phone:_.company.phone||""},!0)):v({type:"error",message:_.message||"Error al actualizar"})}catch{v({type:"error",message:"Error al actualizar empresa"})}finally{l(H,!1)}}async function _a(){l(X,!0);try{const i=await fetch("/api/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(Fe),role:Te})});if(i.ok)v({type:"success",message:"Invitación enviada"}),l(Fe,""),window.location.reload();else{const _=await i.json();v({type:"error",message:_.message})}}catch{v({type:"error",message:"Error al enviar invitación"})}finally{l(X,!1)}}async function ha(i){if(confirm("¿Seguro que deseas eliminar esta invitación?"))try{const _=await fetch(`/api/invitations/${i}`,{method:"DELETE"});if(_.ok)v({type:"success",message:"Invitación eliminada"}),window.location.reload();else{const ee=await _.json();v({type:"error",message:ee.message})}}catch{v({type:"error",message:"Error al eliminar"})}}function m(i){v({type:"info",message:"Funcionalidad de invitación pendiente de actualizar"})}function h(i){return new Date(i).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}function w(i){return"default"}function U(i){return i==="admin"?"Administrador":"Usuario"}async function T(){l(Be,!0);try{const i=await fetch("/api/insurance-companies"),_=await i.json();i.ok?l(qe,_.companies||[],!0):v({type:"error",message:_.message||"Error al cargar aseguradoras"})}catch{v({type:"error",message:"Error al cargar aseguradoras"})}finally{l(Be,!1)}}async function W(){if(!e(Q).name.trim()){v({type:"error",message:"El nombre es requerido"});return}try{const i=e(he)?`/api/insurance-companies/${e(he)}`:"/api/insurance-companies",_=e(he)?"PUT":"POST",ee=await fetch(i,{method:_,headers:{"Content-Type":"application/json"},body:JSON.stringify(e(Q))});if(ee.ok)v({type:"success",message:e(he)?"Aseguradora actualizada":"Aseguradora creada"}),ya(),T();else{const we=await ee.json();v({type:"error",message:we.message||"Error al guardar"})}}catch{v({type:"error",message:"Error al guardar aseguradora"})}}function j(i){l(he,i.id,!0),l(Q,{name:i.name,code:i.code||"",contact_email:i.contact_email||"",contact_phone:i.contact_phone||"",website:i.website||""},!0)}async function We(i,_){if(confirm(`¿Seguro que deseas eliminar "${_}"?`))try{const ee=await fetch(`/api/insurance-companies/${i}`,{method:"DELETE"});if(ee.ok)v({type:"success",message:"Aseguradora eliminada"}),T();else{const we=await ee.json();v({type:"error",message:we.message||"Error al eliminar"})}}catch{v({type:"error",message:"Error al eliminar aseguradora"})}}function ya(){l(he,null),l(Q,{name:"",code:"",contact_email:"",contact_phone:"",website:""},!0)}Sa(()=>{e(d)==="insurers"&&e(qe).length===0&&T()});async function sa(){l(Xe,!0);try{const i=await fetch("/api/config"),_=await i.json();i.ok?l(ta,_.configs||[],!0):v({type:"error",message:_.message||"Error al cargar configuración"})}catch{v({type:"error",message:"Error al cargar configuración"})}finally{l(Xe,!1)}}Sa(()=>{e(d)==="variables"&&e(ta).length===0&&sa()});var Se=is();et(i=>{at.title="Configuración - PAS Manager"});var Ze=s(t(Se),2);it(Ze,{get tabs(){return D},get activeTab(){return e(d)},set activeTab(i){l(d,i,!0)},$$events:{change:i=>l(d,i.detail,!0)},children:(i,_)=>{var ee=ce(),we=$(ee);{var oa=ke=>{Ve(ke,{children:(Ne,la)=>{var Ee=At(),Ce=$(Ee),me=t(Ce),xe=t(me);ft(xe,{size:20}),a(me),J(2),a(Ce);var $e=s(Ce,2),ye=t($e),fe=t(ye),oe=s(t(fe),2);K(oe,{get value(){return x.email},disabled:!0}),J(2),a(fe);var n=s(fe,2),o=s(t(n),2);K(o,{type:"password",placeholder:"Dejar en blanco para no cambiar",get value(){return x.new_password},set value(q){x.new_password=q}}),a(n);var f=s(n,2),p=s(t(f),2);K(p,{type:"password",placeholder:"Confirmar nueva contraseña",get value(){return x.confirm_password},set value(q){x.confirm_password=q}}),a(f),a(ye);var y=s(ye,2),k=t(y);Ie(k,{type:"submit",variant:"primary",get disabled(){return e(C)},children:(q,b)=>{J();var P=_e();R(()=>A(P,e(C)?"Guardando...":"Guardar Cambios")),r(q,P)},$$slots:{default:!0}}),a(y),a($e),da("submit",$e,q=>{q.preventDefault(),Qe()}),r(Ne,Ee)},$$slots:{default:!0}})},ba=ke=>{var Ne=ce(),la=$(Ne);{var Ee=me=>{Ve(me,{children:(xe,$e)=>{var ye=Dt(),fe=$(ye),oe=t(fe),n=t(oe);ua(n,{size:20}),a(oe),J(2),a(fe);var o=s(fe,2),f=t(o),p=t(f),y=s(t(p),2);K(y,{placeholder:"Mi Empresa S.A.",required:!0,get value(){return e(B).name},set value(z){e(B).name=z}}),a(p);var k=s(p,2),q=s(t(k),2);K(q,{placeholder:"Calle Principal 123",get value(){return e(B).address},set value(z){e(B).address=z}}),a(k);var b=s(k,2),P=s(t(b),2);K(P,{placeholder:"Madrid",get value(){return e(B).city},set value(z){e(B).city=z}}),a(b);var S=s(b,2),F=s(t(S),2);K(F,{placeholder:"28001",get value(){return e(B).postal_code},set value(z){e(B).postal_code=z}}),a(S);var Z=s(S,2),ae=s(t(Z),2);K(ae,{type:"tel",placeholder:"+34 900 000 000",get value(){return e(B).phone},set value(z){e(B).phone=z}}),a(Z),a(f);var O=s(f,2),te=t(O);Ie(te,{type:"submit",variant:"primary",get disabled(){return e(H)},children:(z,le)=>{J();var se=_e();R(()=>A(se,e(H)?"Guardando...":"Guardar Cambios")),r(z,se)},$$slots:{default:!0}}),a(O),a(o),da("submit",o,z=>{z.preventDefault(),ga()}),r(xe,ye)},$$slots:{default:!0}})},Ce=me=>{var xe=ce(),$e=$(xe);{var ye=oe=>{Ve(oe,{children:(n,o)=>{var f=Qt(),p=$(f),y=t(p),k=t(y);ua(k,{size:20}),a(y),J(2),a(p);var q=s(p,2),b=t(q),P=t(b),S=s(t(P),2);K(S,{placeholder:"Ej: Mapfre, AXA, Zurich...",required:!0,get value(){return e(Q).name},set value(g){e(Q).name=g}}),a(P);var F=s(P,2),Z=s(t(F),2);K(Z,{placeholder:"Código corto",get value(){return e(Q).code},set value(g){e(Q).code=g}}),a(F);var ae=s(F,2),O=s(t(ae),2);K(O,{type:"email",placeholder:"contacto@compania.com",get value(){return e(Q).contact_email},set value(g){e(Q).contact_email=g}}),a(ae);var te=s(ae,2),z=s(t(te),2);K(z,{type:"tel",placeholder:"+34 900 000 000",get value(){return e(Q).contact_phone},set value(g){e(Q).contact_phone=g}}),a(te);var le=s(te,2),se=s(t(le),2);K(se,{type:"url",placeholder:"https://www.compania.com",get value(){return e(Q).website},set value(g){e(Q).website=g}}),a(le),a(b);var re=s(b,2),Pe=t(re);{var pe=g=>{Ie(g,{variant:"ghost",onclick:ya,type:"button",children:(L,Y)=>{J();var ge=_e("Cancelar");r(L,ge)},$$slots:{default:!0}})};E(Pe,g=>{e(he)&&g(pe)})}var Ae=s(Pe,2);Ie(Ae,{type:"submit",variant:"primary",children:(g,L)=>{var Y=ce(),ge=$(Y);{var de=G=>{var be=_e("Actualizar");r(G,be)},ie=G=>{var be=Mt(),je=$(be);pa(je,{size:18}),J(),r(G,be)};E(ge,G=>{e(he)?G(de):G(ie,!1)})}r(g,Y)},$$slots:{default:!0}}),a(re),a(q);var De=s(q,2);{var I=g=>{var L=Lt();r(g,L)},M=g=>{var L=ce(),Y=$(L);{var ge=ie=>{wa(ie,{get icon(){return ua},title:"No hay aseguradoras registradas",description:"Comienza agregando tu primera compañía de seguros"})},de=ie=>{var G=Xt(),be=t(G);Na(be,{children:(je,Me)=>{var Le=Ht(),ze=s($(Le),2);aa(ze,21,()=>e(qe),ma,(Ue,ne)=>{var na=Rt(),Re=t(na),va=t(Re),za=t(va);ua(za,{size:16});var Ba=s(za);a(va),a(Re);var ja=s(Re),Fa=t(ja);{var Ga=ve=>{var ue=Ut(),Ke=t(ue,!0);a(ue),R(()=>A(Ke,e(ne).code)),r(ve,ue)},Ja=ve=>{var ue=Ot();r(ve,ue)};E(Fa,ve=>{e(ne).code?ve(Ga):ve(Ja,!1)})}a(ja);var qa=s(ja),Ra=t(qa);{var Ha=ve=>{var ue=Vt(),Ke=t(ue,!0);a(ue),R(()=>A(Ke,e(ne).contact_email)),r(ve,ue)},Xa=ve=>{var ue=ce(),Ke=$(ue);{var Za=He=>{var ea=Bt(),Ka=t(ea,!0);a(ea),R(()=>A(Ka,e(ne).contact_phone)),r(He,ea)},Ya=He=>{var ea=Ft();r(He,ea)};E(Ke,He=>{e(ne).contact_phone?He(Za):He(Ya,!1)},!0)}r(ve,ue)};E(Ra,ve=>{e(ne).contact_email?ve(Ha):ve(Xa,!1)})}a(qa);var Ia=s(qa),Ta=t(Ia),ca=t(Ta);ca.__click=[Gt,j,ne];var Qa=t(ca);ot(Qa,{size:16}),a(ca);var $a=s(ca,2);$a.__click=[Jt,We,ne];var Wa=t($a);ka(Wa,{size:16}),a($a),a(Ta),a(Ia),a(na),R(()=>A(Ba,` ${e(ne).name??""}`)),r(Ue,na)}),a(ze),r(je,Le)},$$slots:{default:!0}}),a(G),r(ie,G)};E(Y,ie=>{e(qe).length===0?ie(ge):ie(de,!1)},!0)}r(g,L)};E(De,g=>{e(Be)?g(I):g(M,!1)})}da("submit",q,g=>{g.preventDefault(),W()}),r(n,f)},$$slots:{default:!0}})},fe=oe=>{var n=ce(),o=$(n);{var f=y=>{Nt(y,{})},p=y=>{var k=ce(),q=$(k);{var b=S=>{Ve(S,{children:(F,Z)=>{var ae=as(),O=$(ae),te=t(O),z=t(te);Ma(z,{size:20}),a(te),J(2),a(O);var le=s(O,2),se=t(le),re=t(se);K(re,{type:"email",placeholder:"correo@ejemplo.com",required:!0,get value(){return e(Fe)},set value(I){l(Fe,I,!0)}});var Pe=s(re,2);Ie(Pe,{type:"submit",variant:"primary",get disabled(){return e(X)},children:(I,M)=>{var g=Wt(),L=$(g);pa(L,{size:18});var Y=s(L);R(()=>A(Y,` ${e(X)?"Enviando...":"Enviar Invitación"}`)),r(I,g)},$$slots:{default:!0}}),a(se),a(le);var pe=s(le,2);{var Ae=I=>{wa(I,{get icon(){return Ma},title:"Sin invitaciones",description:"No hay invitaciones pendientes"})},De=I=>{var M=es();aa(M,21,()=>c.data.invitations,ma,(g,L)=>{var Y=Kt(),ge=t(Y),de=t(ge),ie=t(de,!0);a(de);var G=s(de,2),be=t(G);a(G),a(ge);var je=s(ge,2),Me=t(je);Me.__click=[Zt,m,L];var Le=t(Me);pt(Le,{size:16}),a(Me);var ze=s(Me,2);ze.__click=[Yt,ha,L];var Ue=t(ze);ka(Ue,{size:16}),a(ze),a(je),a(Y),R(ne=>{A(ie,e(L).email),A(be,`Enviada ${ne??""}`)},[()=>h(e(L).created_at)]),r(g,Y)}),a(M),r(I,M)};E(pe,I=>{c.data.invitations.length===0?I(Ae):I(De,!1)})}da("submit",le,I=>{I.preventDefault(),_a()}),r(F,ae)},$$slots:{default:!0}})},P=S=>{var F=ce(),Z=$(F);{var ae=O=>{Ve(O,{children:(te,z)=>{var le=rs(),se=$(le),re=t(se),Pe=t(re);La(Pe,{size:20}),a(re),J(2),a(se);var pe=s(se,2);{var Ae=I=>{wa(I,{get icon(){return La},title:"Sin usuarios",description:"No hay usuarios registrados"})},De=I=>{Na(I,{children:(M,g)=>{var L=ss(),Y=s($(L),2);aa(Y,21,()=>c.data.users,ma,(ge,de)=>{var ie=ts(),G=t(ie),be=t(G,!0);a(G);var je=s(G),Me=t(je);{let Ue=tt(()=>w(e(de).role));fa(Me,{get variant(){return e(Ue)},children:(ne,na)=>{J();var Re=_e();R(va=>A(Re,va),[()=>U(e(de).role)]),r(ne,Re)},$$slots:{default:!0}})}a(je);var Le=s(je),ze=t(Le,!0);a(Le),a(ie),R(Ue=>{A(be,e(de).email),A(ze,Ue)},[()=>h(e(de).created_at)]),r(ge,ie)}),a(Y),r(M,L)},$$slots:{default:!0}})};E(pe,I=>{c.data.users.length===0?I(Ae):I(De,!1)})}r(te,le)},$$slots:{default:!0}})};E(Z,O=>{e(d)==="users"&&O(ae)},!0)}r(S,F)};E(q,S=>{e(d)==="invitations"?S(b):S(P,!1)},!0)}r(y,k)};E(o,y=>{e(d)==="variables"?y(f):y(p,!1)},!0)}r(oe,n)};E($e,oe=>{e(d)==="insurers"?oe(ye):oe(fe,!1)},!0)}r(me,xe)};E(la,me=>{e(d)==="company"?me(Ee):me(Ce,!1)},!0)}r(ke,Ne)};E(we,ke=>{e(d)==="profile"?ke(oa):ke(ba,!1)})}r(i,ee)},$$slots:{default:!0}}),a(Se),r(V,Se),Va()}Ua(["click"]);export{Is as component};
