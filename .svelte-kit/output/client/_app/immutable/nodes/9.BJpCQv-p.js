import"../chunks/CWj6FrbW.js";import{c as ue,f as k,a as r,ag as Ua,a7 as Oa,a8 as M,a9 as Le,ad as l,a3 as e,b as f,d as t,r as a,ab as Va,U as s,af as J,ak as he,t as H,ah as L,ae as Ba,B as Sa,aa as at,ac as tt,ai as fa}from"../chunks/dGHTYzhB.js";import{i as z}from"../chunks/_danfitL.js";import{e as ta,r as st,s as rt,i as pa}from"../chunks/X3gEIfGK.js";import{C as Ue}from"../chunks/D80h1qkp.js";import{T as it}from"../chunks/CzrS5ved.js";import{B as ze}from"../chunks/DOI_CNwM.js";import{I as K}from"../chunks/CFvsllsx.js";import{B as ga}from"../chunks/CVV7PiZW.js";import{T as Aa}from"../chunks/1h6XdPlc.js";import{E as $a}from"../chunks/CgF9W7Br.js";import{s as m}from"../chunks/CXhoiRHA.js";import{o as ot}from"../chunks/C_FCoYF_.js";import{c as lt}from"../chunks/CfIVFlu0.js";import{s as Na}from"../chunks/BZZkyLtE.js";import{a as nt}from"../chunks/Bh6sXfGS.js";import"../chunks/Bf0aZHXT.js";import{I as Ca,s as Ea}from"../chunks/DblrYRE4.js";import{l as xa,s as Pa}from"../chunks/pnKjlpSc.js";import{F as vt}from"../chunks/BOk7XFuN.js";import{C as ct}from"../chunks/v23htMxj.js";import{C as Da,P as dt}from"../chunks/B2ofbWwq.js";import{X as ut}from"../chunks/Z30GsDLy.js";import{P as _a}from"../chunks/iyOaMzGm.js";import{T as ka}from"../chunks/jg_9Tfj_.js";import{U as ft}from"../chunks/D9OO-6zb.js";import{S as mt}from"../chunks/cMqDfCCe.js";import{M as Ma}from"../chunks/CDgF3YB_.js";import{U as La}from"../chunks/DaxW58Sj.js";function ma(O,n){const v=xa(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const C=[["path",{d:"M10 12h4"}],["path",{d:"M10 8h4"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16"}]];Ca(O,Pa({name:"building-2"},()=>v,{get iconNode(){return C},children:(X,V)=>{var U=ue(),E=k(U);Ea(E,n,"default",{}),r(X,U)},$$slots:{default:!0}}))}function pt(O,n){const v=xa(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const C=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Ca(O,Pa({name:"copy"},()=>v,{get iconNode(){return C},children:(X,V)=>{var U=ue(),E=k(U);Ea(E,n,"default",{}),r(X,U)},$$slots:{default:!0}}))}function gt(O,n){const v=xa(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const C=[["line",{x1:"12",x2:"12",y1:"2",y2:"22"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"}]];Ca(O,Pa({name:"dollar-sign"},()=>v,{get iconNode(){return C},children:(X,V)=>{var U=ue(),E=k(U);Ea(E,n,"default",{}),r(X,U)},$$slots:{default:!0}}))}function _t(O,n,v){l(n,null),l(v,"")}var ht=f('<div class="loading-state svelte-131nf9n"><p class="svelte-131nf9n">Cargando configuraciones...</p></div>'),yt=f('<div class="show-inactive-toggle svelte-131nf9n"><label class="checkbox-label svelte-131nf9n"><input type="checkbox" class="svelte-131nf9n"/> <span class="svelte-131nf9n">Mostrar items inactivos</span></label></div>'),bt=(O,n,v,C)=>n(e(v).key,e(C)),jt=f('<div class="item-edit-form svelte-131nf9n"><!> <div class="item-actions svelte-131nf9n"><button class="action-btn success svelte-131nf9n" title="Guardar"><!></button> <button class="action-btn svelte-131nf9n" title="Cancelar"><!></button></div></div>'),qt=(O,n,v,C)=>n(e(v).key,e(C)),wt=(O,n,v,C)=>n(e(v).key,e(C)),$t=f('<div class="item-content svelte-131nf9n"><div class="item-label-wrapper svelte-131nf9n"><span class="item-label svelte-131nf9n"> </span> <!></div> <code class="item-value svelte-131nf9n"> </code></div> <div class="item-actions svelte-131nf9n"><button class="action-btn svelte-131nf9n" title="Editar"><!></button> <button><!></button></div>',1),kt=f("<div><!></div>"),Ct=f('<div class="empty-state svelte-131nf9n"><p class="svelte-131nf9n"><!></p></div>'),Et=f("<!> Agregar",1),xt=f('<div class="add-item-input svelte-131nf9n"><!> <!> <!></div>'),Pt=f("<!> ",1),zt=f('<div class="section-header svelte-131nf9n"><div class="section-title svelte-131nf9n"><div class="icon-wrapper svelte-131nf9n"><!></div> <div class="svelte-131nf9n"><h3 class="svelte-131nf9n"> </h3> <p class="section-description svelte-131nf9n"> </p></div></div> <div style="display: flex; gap: var(--space-2); align-items: center;" class="svelte-131nf9n"><!> <!></div></div> <!> <div class="items-list svelte-131nf9n"><!> <!></div> <div class="add-item-form svelte-131nf9n"><!></div>',1),It=f(`<div class="help-content svelte-131nf9n"><h4 class="svelte-131nf9n">💡 Acerca de la configuración</h4> <ul class="svelte-131nf9n"><li class="svelte-131nf9n"><strong class="svelte-131nf9n">Valor automático:</strong> Al agregar un item, se genera automáticamente
              un valor técnico (slug) sin espacios ni acentos para uso interno en
              la base de datos</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Edición del nombre:</strong> Puedes cambiar el nombre visible
              sin afectar el valor técnico, manteniendo la compatibilidad con datos
              existentes</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Desactivación:</strong> En lugar de eliminar, los items se
              desactivan para preservar el historial. Las pólizas existentes mantienen
              su referencia</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Items inactivos:</strong> Los items desactivados no aparecen
              en los formularios nuevos, pero puedes verlos activando el checkbox
              "Mostrar items inactivos"</li> <li class="svelte-131nf9n"><strong class="svelte-131nf9n">Reactivación:</strong> Puedes reactivar items desactivados
              en cualquier momento haciendo clic en el botón de activar (✓)</li></ul></div>`),Tt=f('<div class="sections-grid svelte-131nf9n"></div> <div class="help-section svelte-131nf9n"><!></div>',1),St=f('<div class="config-manager svelte-131nf9n"><!></div>');function At(O,n){Oa(n,!0);let v=M(!1),C=M(Le([{key:"payment_modes",label:"Modos de Pago",icon:gt,description:"Modalidades de pago disponibles para las pólizas",items:[]},{key:"policy_types",label:"Tipos de Póliza",icon:vt,description:"Tipos de pólizas de seguro que se pueden crear",items:[]},{key:"followup_types",label:"Tipos de Seguimiento",icon:ct,description:"Categorías de seguimientos para las pólizas",items:[]}])),X=M(null),V=M(""),U=M(""),E=M(null),B=M(!1);ot(async()=>{await Ie()});async function Ie(){l(v,!0);try{const c=await fetch("/api/config"),_=await c.json();c.ok&&_.configs&&l(C,e(C).map(q=>{const I=_.configs.find(h=>h.config_key===q.key);if(I){let h=[];return Array.isArray(I.config_value)?h=I.config_value.map(re=>({value:Oe(re),label:re,active:!0})):typeof I.config_value=="object"&&I.config_value.items&&(h=I.config_value.items),{...q,items:h}}return q}),!0)}catch(c){console.error("Error loading configurations:",c),m({type:"error",message:"Error al cargar configuraciones"})}finally{l(v,!1)}}function Oe(c){return c.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")}async function fe(c){if(!e(V).trim()){m({type:"error",message:"El nombre no puede estar vacío"});return}const _=e(C).find(h=>h.key===c);if(!_)return;if(_.items.some(h=>h.label.toLowerCase()===e(V).trim().toLowerCase())){m({type:"error",message:"Este item ya existe"});return}const q={value:Oe(e(V)),label:e(V).trim(),active:!0},I=[..._.items,q];await Ve(c,I),l(V,""),l(E,null)}async function W(c,_){if(!e(U).trim()){m({type:"error",message:"El nombre no puede estar vacío"});return}const q=e(C).find(h=>h.key===c);if(!q)return;if(q.items.some((h,re)=>re!==_&&h.label.toLowerCase()===e(U).trim().toLowerCase())){m({type:"error",message:"Este item ya existe"});return}const I=q.items.map((h,re)=>re===_?{value:h.value,label:e(U).trim(),active:h.active??!0}:h);await Ve(c,I),l(X,null),l(U,"")}async function sa(c,_){const q=e(C).find(ye=>ye.key===c);if(!q)return;const I=q.items[_],h=I.active??!0;if(!confirm(`¿Seguro que deseas ${h?"desactivar":"activar"} "${I.label}"?`))return;const w=q.items.map((ye,Fe)=>Fe===_?{...ye,active:!h}:ye);await Ve(c,w)}async function Ve(c,_){try{const q={items:_.map(h=>({value:h.value,label:h.label,active:h.active??!0}))},I=await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config_key:c,config_value:q})});if(I.ok)m({type:"success",message:"Configuración guardada"}),await Ie();else{const h=await I.json();m({type:"error",message:h.message||"Error al guardar"})}}catch{m({type:"error",message:"Error al guardar configuración"})}}function Be(c,_){const q=e(C).find(I=>I.key===c);q&&(l(X,{sectionKey:c,index:_},!0),l(U,q.items[_].label,!0))}function ra(c){return e(B)?c:c.filter(_=>_.active??!0)}function ha(c){return c.filter(_=>_.active??!0).length}function Te(c){return c.filter(_=>!(_.active??!0)).length}var Qe=St(),ya=t(Qe);{var ba=c=>{var _=ht();r(c,_)},ia=c=>{var _=Tt(),q=k(_);ta(q,21,()=>e(C),pa,(re,w)=>{Ue(re,{children:(ye,Fe)=>{var oa=zt(),Ge=k(oa),Re=t(Ge),Je=t(Re),la=t(Je);lt(la,()=>e(w).icon,(d,o)=>{o(d,{size:20})}),a(Je);var Ye=s(Je,2),i=t(Ye),b=t(i,!0);a(i);var Z=s(i,2),Se=t(Z,!0);a(Z),a(Ye),a(Re);var na=s(Re,2),va=t(na);ga(va,{variant:"success",children:(d,o)=>{J();var y=he();H(u=>L(y,`${u??""} activos`),[()=>ha(e(w).items)]),r(d,y)},$$slots:{default:!0}});var Ce=s(va,2);{var He=d=>{ga(d,{variant:"default",children:(o,y)=>{J();var u=he();H(x=>L(u,`${x??""} inactivos`),[()=>Te(e(w).items)]),r(o,u)},$$slots:{default:!0}})};z(Ce,d=>{Te(e(w).items)>0&&d(He)})}a(na),a(Ge);var Ke=s(Ge,2);{var Xe=d=>{var o=yt(),y=t(o),u=t(y);st(u),J(2),a(y),a(o),nt(u,()=>e(B),x=>l(B,x)),r(d,o)};z(Ke,d=>{Te(e(w).items)>0&&d(Xe)})}var $e=s(Ke,2),ne=t($e);ta(ne,19,()=>ra(e(w).items),d=>d.value,(d,o)=>{const y=Ba(()=>e(w).items.findIndex($=>$.value===e(o).value));var u=kt();let x;var p=t(u);{var A=$=>{var D=jt(),F=t(D);K(F,{placeholder:"Nombre del item",autofocus:!0,get value(){return e(U)},set value(Q){l(U,Q,!0)}});var G=s(F,2),N=t(G);N.__click=[bt,W,w,y];var ae=t(N);Da(ae,{size:16}),a(N);var P=s(N,2);P.__click=[_t,X,U];var ee=t(P);ut(ee,{size:16}),a(P),a(G),a(D),r($,D)},S=$=>{var D=$t(),F=k(D),G=t(F),N=t(G),ae=t(N,!0);a(N);var P=s(N,2);{var ee=j=>{ga(j,{variant:"default",children:(Y,ce)=>{J();var te=he("Inactivo");r(Y,te)},$$slots:{default:!0}})};z(P,j=>{(e(o).active??!0)||j(ee)})}a(G);var Q=s(G,2),be=t(Q,!0);a(Q),a(F);var ke=s(F,2),ge=t(ke);ge.__click=[qt,Be,w,y];var Ae=t(ge);dt(Ae,{size:16}),a(ge);var _e=s(ge,2);_e.__click=[wt,sa,w,y];var T=t(_e);{var je=j=>{ka(j,{size:16})},g=j=>{Da(j,{size:16})};z(T,j=>{e(o).active??!0?j(je):j(g,!1)})}a(_e),a(ke),H(()=>{L(ae,e(o).label),L(be,e(o).value),ge.disabled=!(e(o).active??!0),Na(_e,1,`action-btn ${e(o).active??!0?"warning":"success"}`,"svelte-131nf9n"),rt(_e,"title",e(o).active??!0?"Desactivar":"Activar")}),r($,D)};z(p,$=>{var D,F;((D=e(X))==null?void 0:D.sectionKey)===e(w).key&&((F=e(X))==null?void 0:F.index)===e(y)?$(A):$(S,!1)})}a(u),H($=>x=Na(u,1,"item-row svelte-131nf9n",null,x,$),[()=>({inactive:!(e(o).active??!0)})]),r(d,u)});var Ee=s(ne,2);{var xe=d=>{var o=Ct(),y=t(o),u=t(y);{var x=A=>{var S=he();H($=>L(S,`No hay items activos. Hay ${$??""} items
                    inactivos.`),[()=>Te(e(w).items)]),r(A,S)},p=A=>{var S=he("No hay items configurados");r(A,S)};z(u,A=>{Te(e(w).items)>0?A(x):A(p,!1)})}a(y),a(o),r(d,o)};z(Ee,d=>{ra(e(w).items).length===0&&!e(B)&&d(xe)})}a($e);var me=s($e,2),pe=t(me);{var ie=d=>{var o=xt(),y=t(o);K(y,{placeholder:"Nombre del nuevo item",autofocus:!0,onkeydown:p=>{p.key==="Enter"?(p.preventDefault(),fe(e(w).key)):p.key==="Escape"&&(l(E,null),l(V,""))},get value(){return e(V)},set value(p){l(V,p,!0)}});var u=s(y,2);ze(u,{variant:"primary",size:"sm",onclick:()=>fe(e(w).key),children:(p,A)=>{var S=Et(),$=k(S);_a($,{size:16}),J(),r(p,S)},$$slots:{default:!0}});var x=s(u,2);ze(x,{variant:"ghost",size:"sm",onclick:()=>{l(E,null),l(V,"")},children:(p,A)=>{J();var S=he("Cancelar");r(p,S)},$$slots:{default:!0}}),a(o),r(d,o)},ve=d=>{ze(d,{variant:"outline",size:"sm",onclick:()=>l(E,e(w).key,!0),children:(o,y)=>{var u=Pt(),x=k(u);_a(x,{size:16});var p=s(x);H(()=>L(p,` Agregar ${e(w).label??""}`)),r(o,u)},$$slots:{default:!0}})};z(pe,d=>{e(E)===e(w).key?d(ie):d(ve,!1)})}a(me),H(()=>{L(b,e(w).label),L(Se,e(w).description)}),r(ye,oa)},$$slots:{default:!0}})}),a(q);var I=s(q,2),h=t(I);Ue(h,{children:(re,w)=>{var ye=It();r(re,ye)},$$slots:{default:!0}}),a(I),r(c,_)};z(ya,c=>{e(v)?c(ba):c(ia,!1)})}a(Qe),r(O,Qe),Va()}Ua(["click"]);var Nt=f('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Perfil de Usuario</h2> <p class="svelte-6qgtij">Actualiza tu información personal y contraseña</p></div></div> <form class="svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group double-width svelte-6qgtij"><label for="email" class="svelte-6qgtij">Email</label> <!> <small class="help-text svelte-6qgtij">El email no se puede cambiar</small></div> <div class="form-group svelte-6qgtij"><label for="new_password" class="svelte-6qgtij">Nueva Contraseña</label> <!></div> <div class="form-group svelte-6qgtij"><label for="confirm_password" class="svelte-6qgtij">Confirmar Contraseña</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!></div></form>',1),Dt=f('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Datos de la Empresa</h2> <p class="svelte-6qgtij">Información de tu empresa u organización</p></div></div> <form class="svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group double-width svelte-6qgtij"><label for="companyName" class="svelte-6qgtij">Nombre de la Empresa</label> <!></div> <div class="form-group double-width svelte-6qgtij"><label for="companyAddress" class="svelte-6qgtij">Dirección</label> <!></div> <div class="form-group svelte-6qgtij"><label for="companyCity" class="svelte-6qgtij">Ciudad</label> <!></div> <div class="form-group svelte-6qgtij"><label for="companyPostalCode" class="svelte-6qgtij">Código Postal</label> <!></div> <div class="form-group svelte-6qgtij"><label for="companyPhone" class="svelte-6qgtij">Teléfono</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!></div></form>',1),Mt=f("<!> Crear Aseguradora",1),Lt=f('<div class="loading-text svelte-6qgtij">Cargando aseguradoras...</div>'),Ut=f('<span class="code-badge svelte-6qgtij"> </span>'),Ot=f('<span class="text-muted svelte-6qgtij">-</span>'),Vt=f('<span class="contact-info svelte-6qgtij"> </span>'),Bt=f('<span class="contact-info svelte-6qgtij"> </span>'),Ft=f('<span class="text-muted svelte-6qgtij">Sin contacto</span>'),Gt=(O,n,v)=>n(e(v)),Rt=(O,n,v)=>n(e(v).id,e(v).name),Jt=f('<tr class="svelte-6qgtij"><td class="svelte-6qgtij"><div class="insurer-name svelte-6qgtij"><!> </div></td><td class="svelte-6qgtij"><!></td><td class="svelte-6qgtij"><!></td><td class="text-right svelte-6qgtij"><div class="table-actions svelte-6qgtij"><button class="action-btn svelte-6qgtij" title="Editar"><!></button> <button class="action-btn danger svelte-6qgtij" title="Eliminar"><!></button></div></td></tr>'),Ht=f('<thead class="svelte-6qgtij"><tr class="svelte-6qgtij"><th class="svelte-6qgtij">Nombre</th><th class="svelte-6qgtij">Código</th><th class="svelte-6qgtij">Contacto</th><th class="text-right svelte-6qgtij">Acciones</th></tr></thead> <tbody class="svelte-6qgtij"></tbody>',1),Xt=f('<div class="insurers-table svelte-6qgtij"><!></div>'),Wt=f('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Compañías de Seguros</h2> <p class="svelte-6qgtij">Gestiona las aseguradoras disponibles en el sistema</p></div></div> <form class="insurer-form svelte-6qgtij"><div class="form-grid svelte-6qgtij"><div class="form-group svelte-6qgtij"><label for="insurerName" class="svelte-6qgtij">Nombre *</label> <!></div> <div class="form-group svelte-6qgtij"><label for="insurerCode" class="svelte-6qgtij">Código</label> <!></div> <div class="form-group svelte-6qgtij"><label for="insurerContactEmail" class="svelte-6qgtij">Email de contacto</label> <!></div> <div class="form-group svelte-6qgtij"><label for="insurerContactPhone" class="svelte-6qgtij">Teléfono</label> <!></div> <div class="form-group full-width svelte-6qgtij"><label for="insurerWebsite" class="svelte-6qgtij">Sitio web</label> <!></div></div> <div class="form-actions svelte-6qgtij"><!> <!></div></form> <!>',1),Zt=f("<!> ",1),Qt=(O,n,v)=>n(e(v).token),Yt=(O,n,v)=>n(e(v).id),Kt=f('<div class="invitation-item svelte-6qgtij"><div class="invitation-info svelte-6qgtij"><div class="invitation-email svelte-6qgtij"> </div> <div class="invitation-meta svelte-6qgtij"> </div></div> <div class="invitation-actions svelte-6qgtij"><button class="action-btn svelte-6qgtij" title="Copiar link"><!></button> <button class="action-btn danger svelte-6qgtij" title="Eliminar"><!></button></div></div>'),es=f('<div class="invitations-list svelte-6qgtij"></div>'),as=f('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Invitaciones</h2> <p class="svelte-6qgtij">Invita a nuevos usuarios a unirse a tu empresa</p></div></div> <form class="invite-form svelte-6qgtij"><div class="invite-inputs svelte-6qgtij"><!> <!></div></form> <!>',1),ts=f('<tr class="svelte-6qgtij"><td class="svelte-6qgtij"> </td><td class="svelte-6qgtij"><!></td><td class="svelte-6qgtij"> </td></tr>'),ss=f('<thead class="svelte-6qgtij"><tr class="svelte-6qgtij"><th class="svelte-6qgtij">Email</th><th class="svelte-6qgtij">Rol</th><th class="svelte-6qgtij">Fecha de Registro</th></tr></thead> <tbody class="svelte-6qgtij"></tbody>',1),rs=f('<div class="section-header svelte-6qgtij"><div class="icon-wrapper svelte-6qgtij"><!></div> <div class="svelte-6qgtij"><h2 class="svelte-6qgtij">Usuarios</h2> <p class="svelte-6qgtij">Usuarios con acceso a la empresa</p></div></div> <!>',1),is=f('<div class="page svelte-6qgtij"><div class="page-header svelte-6qgtij"><div class="svelte-6qgtij"><h1 class="svelte-6qgtij">Configuración</h1> <p class="svelte-6qgtij">Administra la configuración de tu empresa y perfil</p></div></div> <!></div>');function Ns(O,n){var Ge,Re,Je,la,Ye;Oa(n,!0);let v=M("profile"),C=M(!1),X=M(!1),V=M(!1);const U=[{id:"profile",label:"Perfil"},{id:"company",label:"Empresa"},{id:"insurers",label:"Aseguradoras"},{id:"variables",label:"Variables"},{id:"invitations",label:"Invitaciones"},{id:"users",label:"Usuarios"}];let E=Le({email:n.data.user.email||"",current_password:"",new_password:"",confirm_password:""}),B=M(Le({name:((Ge=n.data.company)==null?void 0:Ge.name)||"",address:((Re=n.data.company)==null?void 0:Re.address)||"",city:((Je=n.data.company)==null?void 0:Je.city)||"",postal_code:((la=n.data.company)==null?void 0:la.postal_code)||"",phone:((Ye=n.data.company)==null?void 0:Ye.phone)||""})),Ie=M(Le([])),Oe=M(!1),fe=M(null),W=M(Le({name:"",code:"",contact_email:"",contact_phone:"",website:""})),sa=M(Le([])),Ve=M(!1);M(Le({config_key:"",config_value:""}));let Be=M(""),ra="user";async function ha(){l(C,!0);try{const i={};if(E.new_password){if(E.new_password!==E.confirm_password){m({type:"error",message:"Las contraseñas no coinciden"});return}i.password=E.new_password}if(Object.keys(i).length>0){const b=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(b.ok)m({type:"success",message:"Perfil actualizado"}),E.current_password="",E.new_password="",E.confirm_password="";else{const Z=await b.json();m({type:"error",message:Z.message})}}}catch{m({type:"error",message:"Error al actualizar perfil"})}finally{l(C,!1)}}async function Te(){l(X,!0);try{const i=await fetch("/api/company",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(B))}),b=await i.json();i.ok?(m({type:"success",message:"Empresa actualizada"}),b.company&&l(B,{name:b.company.name||"",address:b.company.address||"",city:b.company.city||"",postal_code:b.company.postal_code||"",phone:b.company.phone||""},!0)):m({type:"error",message:b.message||"Error al actualizar"})}catch{m({type:"error",message:"Error al actualizar empresa"})}finally{l(X,!1)}}async function Qe(){l(V,!0);try{const i=await fetch("/api/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(Be),role:ra})});if(i.ok)m({type:"success",message:"Invitación enviada"}),l(Be,""),window.location.reload();else{const b=await i.json();m({type:"error",message:b.message})}}catch{m({type:"error",message:"Error al enviar invitación"})}finally{l(V,!1)}}async function ya(i){if(confirm("¿Seguro que deseas eliminar esta invitación?"))try{const b=await fetch(`/api/invitations/${i}`,{method:"DELETE"});if(b.ok)m({type:"success",message:"Invitación eliminada"}),window.location.reload();else{const Z=await b.json();m({type:"error",message:Z.message})}}catch{m({type:"error",message:"Error al eliminar"})}}function ba(i){m({type:"info",message:"Funcionalidad de invitación pendiente de actualizar"})}function ia(i){return new Date(i).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}function c(i){return"default"}function _(i){return i==="admin"?"Administrador":"Usuario"}async function q(){l(Oe,!0);try{const i=await fetch("/api/insurance-companies"),b=await i.json();i.ok?l(Ie,b.companies||[],!0):m({type:"error",message:b.message||"Error al cargar aseguradoras"})}catch{m({type:"error",message:"Error al cargar aseguradoras"})}finally{l(Oe,!1)}}async function I(){if(!e(W).name.trim()){m({type:"error",message:"El nombre es requerido"});return}try{const i=e(fe)?`/api/insurance-companies/${e(fe)}`:"/api/insurance-companies",b=e(fe)?"PUT":"POST",Z=await fetch(i,{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify(e(W))});if(Z.ok)m({type:"success",message:e(fe)?"Aseguradora actualizada":"Aseguradora creada"}),w(),q();else{const Se=await Z.json();m({type:"error",message:Se.message||"Error al guardar"})}}catch{m({type:"error",message:"Error al guardar aseguradora"})}}function h(i){l(fe,i.id,!0),l(W,{name:i.name,code:i.code||"",contact_email:i.contact_email||"",contact_phone:i.contact_phone||"",website:i.website||""},!0)}async function re(i,b){if(confirm(`¿Seguro que deseas eliminar "${b}"?`))try{const Z=await fetch(`/api/insurance-companies/${i}`,{method:"DELETE"});if(Z.ok)m({type:"success",message:"Aseguradora eliminada"}),q();else{const Se=await Z.json();m({type:"error",message:Se.message||"Error al eliminar"})}}catch{m({type:"error",message:"Error al eliminar aseguradora"})}}function w(){l(fe,null),l(W,{name:"",code:"",contact_email:"",contact_phone:"",website:""},!0)}Sa(()=>{e(v)==="insurers"&&e(Ie).length===0&&q()});async function ye(){l(Ve,!0);try{const i=await fetch("/api/config"),b=await i.json();i.ok?l(sa,b.configs||[],!0):m({type:"error",message:b.message||"Error al cargar configuración"})}catch{m({type:"error",message:"Error al cargar configuración"})}finally{l(Ve,!1)}}Sa(()=>{e(v)==="variables"&&e(sa).length===0&&ye()});var Fe=is();at(i=>{tt.title="Configuración - PAS Manager"});var oa=s(t(Fe),2);it(oa,{get tabs(){return U},get activeTab(){return e(v)},set activeTab(i){l(v,i,!0)},$$events:{change:i=>l(v,i.detail,!0)},children:(i,b)=>{var Z=ue(),Se=k(Z);{var na=Ce=>{Ue(Ce,{children:(He,Ke)=>{var Xe=Nt(),$e=k(Xe),ne=t($e),Ee=t(ne);ft(Ee,{size:20}),a(ne),J(2),a($e);var xe=s($e,2),me=t(xe),pe=t(me),ie=s(t(pe),2);K(ie,{get value(){return E.email},disabled:!0}),J(2),a(pe);var ve=s(pe,2),d=s(t(ve),2);K(d,{type:"password",placeholder:"Dejar en blanco para no cambiar",get value(){return E.new_password},set value(p){E.new_password=p}}),a(ve);var o=s(ve,2),y=s(t(o),2);K(y,{type:"password",placeholder:"Confirmar nueva contraseña",get value(){return E.confirm_password},set value(p){E.confirm_password=p}}),a(o),a(me);var u=s(me,2),x=t(u);ze(x,{type:"submit",variant:"primary",get disabled(){return e(C)},children:(p,A)=>{J();var S=he();H(()=>L(S,e(C)?"Guardando...":"Guardar Cambios")),r(p,S)},$$slots:{default:!0}}),a(u),a(xe),fa("submit",xe,p=>{p.preventDefault(),ha()}),r(He,Xe)},$$slots:{default:!0}})},va=Ce=>{var He=ue(),Ke=k(He);{var Xe=ne=>{Ue(ne,{children:(Ee,xe)=>{var me=Dt(),pe=k(me),ie=t(pe),ve=t(ie);ma(ve,{size:20}),a(ie),J(2),a(pe);var d=s(pe,2),o=t(d),y=t(o),u=s(t(y),2);K(u,{placeholder:"Mi Empresa S.A.",required:!0,get value(){return e(B).name},set value(P){e(B).name=P}}),a(y);var x=s(y,2),p=s(t(x),2);K(p,{placeholder:"Calle Principal 123",get value(){return e(B).address},set value(P){e(B).address=P}}),a(x);var A=s(x,2),S=s(t(A),2);K(S,{placeholder:"Madrid",get value(){return e(B).city},set value(P){e(B).city=P}}),a(A);var $=s(A,2),D=s(t($),2);K(D,{placeholder:"28001",get value(){return e(B).postal_code},set value(P){e(B).postal_code=P}}),a($);var F=s($,2),G=s(t(F),2);K(G,{type:"tel",placeholder:"+34 900 000 000",get value(){return e(B).phone},set value(P){e(B).phone=P}}),a(F),a(o);var N=s(o,2),ae=t(N);ze(ae,{type:"submit",variant:"primary",get disabled(){return e(X)},children:(P,ee)=>{J();var Q=he();H(()=>L(Q,e(X)?"Guardando...":"Guardar Cambios")),r(P,Q)},$$slots:{default:!0}}),a(N),a(d),fa("submit",d,P=>{P.preventDefault(),Te()}),r(Ee,me)},$$slots:{default:!0}})},$e=ne=>{var Ee=ue(),xe=k(Ee);{var me=ie=>{Ue(ie,{children:(ve,d)=>{var o=Wt(),y=k(o),u=t(y),x=t(u);ma(x,{size:20}),a(u),J(2),a(y);var p=s(y,2),A=t(p),S=t(A),$=s(t(S),2);K($,{placeholder:"Ej: Mapfre, AXA, Zurich...",required:!0,get value(){return e(W).name},set value(g){e(W).name=g}}),a(S);var D=s(S,2),F=s(t(D),2);K(F,{placeholder:"Código corto",get value(){return e(W).code},set value(g){e(W).code=g}}),a(D);var G=s(D,2),N=s(t(G),2);K(N,{type:"email",placeholder:"contacto@compania.com",get value(){return e(W).contact_email},set value(g){e(W).contact_email=g}}),a(G);var ae=s(G,2),P=s(t(ae),2);K(P,{type:"tel",placeholder:"+34 900 000 000",get value(){return e(W).contact_phone},set value(g){e(W).contact_phone=g}}),a(ae);var ee=s(ae,2),Q=s(t(ee),2);K(Q,{type:"url",placeholder:"https://www.compania.com",get value(){return e(W).website},set value(g){e(W).website=g}}),a(ee),a(A);var be=s(A,2),ke=t(be);{var ge=g=>{ze(g,{variant:"ghost",onclick:w,type:"button",children:(j,Y)=>{J();var ce=he("Cancelar");r(j,ce)},$$slots:{default:!0}})};z(ke,g=>{e(fe)&&g(ge)})}var Ae=s(ke,2);ze(Ae,{type:"submit",variant:"primary",children:(g,j)=>{var Y=ue(),ce=k(Y);{var te=R=>{var qe=he("Actualizar");r(R,qe)},se=R=>{var qe=Mt(),we=k(qe);_a(we,{size:18}),J(),r(R,qe)};z(ce,R=>{e(fe)?R(te):R(se,!1)})}r(g,Y)},$$slots:{default:!0}}),a(be),a(p);var _e=s(p,2);{var T=g=>{var j=Lt();r(g,j)},je=g=>{var j=ue(),Y=k(j);{var ce=se=>{$a(se,{get icon(){return ma},title:"No hay aseguradoras registradas",description:"Comienza agregando tu primera compañía de seguros"})},te=se=>{var R=Xt(),qe=t(R);Aa(qe,{children:(we,Ne)=>{var De=Ht(),Pe=s(k(De),2);ta(Pe,21,()=>e(Ie),pa,(Me,oe)=>{var ca=Jt(),We=t(ca),da=t(We),za=t(da);ma(za,{size:16});var Fa=s(za);a(da),a(We);var ja=s(We),Ga=t(ja);{var Ra=le=>{var de=Ut(),ea=t(de,!0);a(de),H(()=>L(ea,e(oe).code)),r(le,de)},Ja=le=>{var de=Ot();r(le,de)};z(Ga,le=>{e(oe).code?le(Ra):le(Ja,!1)})}a(ja);var qa=s(ja),Ha=t(qa);{var Xa=le=>{var de=Vt(),ea=t(de,!0);a(de),H(()=>L(ea,e(oe).contact_email)),r(le,de)},Wa=le=>{var de=ue(),ea=k(de);{var Ya=Ze=>{var aa=Bt(),et=t(aa,!0);a(aa),H(()=>L(et,e(oe).contact_phone)),r(Ze,aa)},Ka=Ze=>{var aa=Ft();r(Ze,aa)};z(ea,Ze=>{e(oe).contact_phone?Ze(Ya):Ze(Ka,!1)},!0)}r(le,de)};z(Ha,le=>{e(oe).contact_email?le(Xa):le(Wa,!1)})}a(qa);var Ia=s(qa),Ta=t(Ia),ua=t(Ta);ua.__click=[Gt,h,oe];var Za=t(ua);mt(Za,{size:16}),a(ua);var wa=s(ua,2);wa.__click=[Rt,re,oe];var Qa=t(wa);ka(Qa,{size:16}),a(wa),a(Ta),a(Ia),a(ca),H(()=>L(Fa,` ${e(oe).name??""}`)),r(Me,ca)}),a(Pe),r(we,De)},$$slots:{default:!0}}),a(R),r(se,R)};z(Y,se=>{e(Ie).length===0?se(ce):se(te,!1)},!0)}r(g,j)};z(_e,g=>{e(Oe)?g(T):g(je,!1)})}fa("submit",p,g=>{g.preventDefault(),I()}),r(ve,o)},$$slots:{default:!0}})},pe=ie=>{var ve=ue(),d=k(ve);{var o=u=>{At(u,{})},y=u=>{var x=ue(),p=k(x);{var A=$=>{Ue($,{children:(D,F)=>{var G=as(),N=k(G),ae=t(N),P=t(ae);Ma(P,{size:20}),a(ae),J(2),a(N);var ee=s(N,2),Q=t(ee),be=t(Q);K(be,{type:"email",placeholder:"correo@ejemplo.com",required:!0,get value(){return e(Be)},set value(T){l(Be,T,!0)}});var ke=s(be,2);ze(ke,{type:"submit",variant:"primary",get disabled(){return e(V)},children:(T,je)=>{var g=Zt(),j=k(g);_a(j,{size:18});var Y=s(j);H(()=>L(Y,` ${e(V)?"Enviando...":"Enviar Invitación"}`)),r(T,g)},$$slots:{default:!0}}),a(Q),a(ee);var ge=s(ee,2);{var Ae=T=>{$a(T,{get icon(){return Ma},title:"Sin invitaciones",description:"No hay invitaciones pendientes"})},_e=T=>{var je=es();ta(je,21,()=>n.data.invitations,pa,(g,j)=>{var Y=Kt(),ce=t(Y),te=t(ce),se=t(te,!0);a(te);var R=s(te,2),qe=t(R);a(R),a(ce);var we=s(ce,2),Ne=t(we);Ne.__click=[Qt,ba,j];var De=t(Ne);pt(De,{size:16}),a(Ne);var Pe=s(Ne,2);Pe.__click=[Yt,ya,j];var Me=t(Pe);ka(Me,{size:16}),a(Pe),a(we),a(Y),H(oe=>{L(se,e(j).email),L(qe,`Enviada ${oe??""}`)},[()=>ia(e(j).created_at)]),r(g,Y)}),a(je),r(T,je)};z(ge,T=>{n.data.invitations.length===0?T(Ae):T(_e,!1)})}fa("submit",ee,T=>{T.preventDefault(),Qe()}),r(D,G)},$$slots:{default:!0}})},S=$=>{var D=ue(),F=k(D);{var G=N=>{Ue(N,{children:(ae,P)=>{var ee=rs(),Q=k(ee),be=t(Q),ke=t(be);La(ke,{size:20}),a(be),J(2),a(Q);var ge=s(Q,2);{var Ae=T=>{$a(T,{get icon(){return La},title:"Sin usuarios",description:"No hay usuarios registrados"})},_e=T=>{Aa(T,{children:(je,g)=>{var j=ss(),Y=s(k(j),2);ta(Y,21,()=>n.data.users,pa,(ce,te)=>{var se=ts(),R=t(se),qe=t(R,!0);a(R);var we=s(R),Ne=t(we);{let Me=Ba(()=>c(e(te).role));ga(Ne,{get variant(){return e(Me)},children:(oe,ca)=>{J();var We=he();H(da=>L(We,da),[()=>_(e(te).role)]),r(oe,We)},$$slots:{default:!0}})}a(we);var De=s(we),Pe=t(De,!0);a(De),a(se),H(Me=>{L(qe,e(te).email),L(Pe,Me)},[()=>ia(e(te).created_at)]),r(ce,se)}),a(Y),r(je,j)},$$slots:{default:!0}})};z(ge,T=>{n.data.users.length===0?T(Ae):T(_e,!1)})}r(ae,ee)},$$slots:{default:!0}})};z(F,N=>{e(v)==="users"&&N(G)},!0)}r($,D)};z(p,$=>{e(v)==="invitations"?$(A):$(S,!1)},!0)}r(u,x)};z(d,u=>{e(v)==="variables"?u(o):u(y,!1)},!0)}r(ie,ve)};z(xe,ie=>{e(v)==="insurers"?ie(me):ie(pe,!1)},!0)}r(ne,Ee)};z(Ke,ne=>{e(v)==="company"?ne(Xe):ne($e,!1)},!0)}r(Ce,He)};z(Se,Ce=>{e(v)==="profile"?Ce(na):Ce(va,!1)})}r(i,Z)},$$slots:{default:!0}}),a(Fe),r(O,Fe),Va()}Ua(["click"]);export{Ns as component};
